

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Hydrogen Atom &#8212; Computation in Quantum Mechanics  (for Phys486)# The title of the book. Will be placed in the left navbar.</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=5b4479735964841361fd" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=5b4479735964841361fd" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=5b4479735964841361fd" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd" />
  <script src="_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=5b4479735964841361fd"></script>

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Hydrogen';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Harmonic Oscillator" href="HarmonicOscillator.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="Computation in Quantum Mechanics  (for Phys486)# The title of the book. Will be placed in the left navbar. - Home"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="Computation in Quantum Mechanics  (for Phys486)# The title of the book. Will be placed in the left navbar. - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Quantum Mechanics
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="ParticleInABox.html">Particle in a Box</a></li>
<li class="toctree-l1"><a class="reference internal" href="ParticleInAFiniteWell.html">Particle with a Finite Potential</a></li>
<li class="toctree-l1"><a class="reference internal" href="HarmonicOscillator.html">Harmonic Oscillator</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Hydrogen Atom</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/illinois-compphys/QM/blob/main/quantum_mechanics/Hydrogen.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/Hydrogen.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Hydrogen Atom</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-1-plotting-the-hydrogen-atom-orbitals">Exercise 1.  Plotting the Hydrogen Atom Orbitals</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-radial-function">a. Radial Function</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#b-hydrogen-orbitals">b. Hydrogen Orbitals</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#c-getting-the-energy-of-the-hydrogen-atom">c. Getting the Energy of the Hydrogen Atom</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-2-solving-the-hydrogen-atom-radial-equation-numerically">Exercise 2. Solving the Hydrogen Atom Radial Equation Numerically</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-the-kinetic-term">a. The Kinetic Term</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#b-the-potential-terms">b. The potential terms</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#c-putting-it-together">c. Putting it together</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#d-finer-grids">d. Finer Grids</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-3-hydrogen-atom-on-a-grid">Exercise 3. Hydrogen Atom on a Grid</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-the-hamiltonian">a. The Hamiltonian</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#b-eigenvalues">b. Eigenvalues</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#c-eigenvectors">c. Eigenvectors</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#c-three-dimensional-plots">c.  Three-dimensional plots</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="hydrogen-atom">
<h1>Hydrogen Atom<a class="headerlink" href="#hydrogen-atom" title="Permalink to this heading">#</a></h1>
<ul class="simple">
<li><p><strong>Author:</strong></p></li>
<li><p><strong>Date:</strong></p></li>
<li><p><strong>Time spent on this assignment:</strong></p></li>
</ul>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">scipy</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">scipy.sparse</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">scipy.sparse.linalg</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">plotly.graph_objects</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">go</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.constants</span><span class="w"> </span><span class="kn">import</span> <span class="n">physical_constants</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">scipy.special</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sp</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mpl_toolkits.mplot3d</span><span class="w"> </span><span class="kn">import</span> <span class="n">Axes3D</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">math</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">line</span> <span class="mi">4</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="kn">from</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="ne">----&gt; </span><span class="mi">4</span> <span class="kn">import</span><span class="w"> </span><span class="nn">scipy</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="kn">import</span><span class="w"> </span><span class="nn">scipy.sparse</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span> <span class="kn">import</span><span class="w"> </span><span class="nn">scipy.sparse.linalg</span>

<span class="ne">ModuleNotFoundError</span>: No module named &#39;scipy&#39;
</pre></div>
</div>
</div>
</details>
</div>
<p>Throughout this exercise, we are going to work in atomic units where <span class="math notranslate nohighlight">\(\hbar=m=e=1/(4\pi\epsilon_0)=1\)</span>.  This gives us the Bohr radius which is also equal to 1 in these units (and <span class="math notranslate nohighlight">\(0.529 \times 10^{-10}\)</span> m in SI units).  All distances in this unit will be measured in Bohr radii.</p>
<section id="exercise-1-plotting-the-hydrogen-atom-orbitals">
<h2>Exercise 1.  Plotting the Hydrogen Atom Orbitals<a class="headerlink" href="#exercise-1-plotting-the-hydrogen-atom-orbitals" title="Permalink to this heading">#</a></h2>
<p>In this exercise, we are going to plot the orbitals of the Hydrogen atom starting from the relevant solutions that you found analytically.  In future exercises, we will see how to get these results from scratch without using the analytic solutions.</p>
<p>Recall that the Hydrogen atom wave-function is</p>
<div class="math notranslate nohighlight">
\[ \Psi_{nlm}(r,\theta,\phi) = R_{nl}(r) Y_{lm}(\theta,\phi)\]</div>
<section id="a-radial-function">
<h3>a. Radial Function<a class="headerlink" href="#a-radial-function" title="Permalink to this heading">#</a></h3>
<p>Let us start by getting the radial wave-function of the Hydrogen atom working.  Recall that the radial wave-function is</p>
<div class="math notranslate nohighlight">
\[
R_{nl}(r) = \frac{u_{nl}(r)}{r} = N \exp(-\rho / 2)  \rho^l  L^{n-l-1}_{2l+1}(\rho)
\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[\rho = \frac{2r}{na_0}\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[N = \sqrt{\left(\frac{2 }{n a_0}\right)^3 \frac{(n - l - 1)!}{2n (n + l)!}}\]</div>
<p>and <span class="math notranslate nohighlight">\(L\)</span> is a special function which can be generated by doing <code class="docutils literal notranslate"><span class="pre">L=sp.genlaguerre(n-l-1,2*l+1)</span></code>.  Note that this just returns the python function. Later you will have to call <code class="docutils literal notranslate"><span class="pre">L(rho)</span></code>.</p>
<p>Write a function <code class="docutils literal notranslate"><span class="pre">radial_function(n,</span> <span class="pre">l,</span> <span class="pre">r)</span></code> which takes <span class="math notranslate nohighlight">\(n\)</span>, <span class="math notranslate nohighlight">\(l\)</span>, and <span class="math notranslate nohighlight">\(r\)</span> and returns <span class="math notranslate nohighlight">\(R_{nl}(r)\)</span>.  Recall we are in units where <span class="math notranslate nohighlight">\(a_0=1\)</span>.</p>
<p>Let’s start by evaluating this on a one-dimensional grid of positions <code class="docutils literal notranslate"><span class="pre">r=np.linspace(0.001,45,1000)</span></code>.</p>
<p>Plot on the same plot, <span class="math notranslate nohighlight">\(u_{nl}(r)\)</span> (notice this is different from <span class="math notranslate nohighlight">\(R_{nl}\)</span> by a factor of <span class="math notranslate nohighlight">\(r\)</span>) for</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\((n,\ell) = (1,0)\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\((n,\ell) = (2,0)\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\((n,\ell) = (3,0)\)</span></p></li>
</ul>
<p>How do the number of nodes (times when it hits zero) correspond to the value of <span class="math notranslate nohighlight">\(n\)</span>?</p>
<p>Now also plot</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\((n,\ell) = (3,2)\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\((n,\ell) = (3,1)\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\((n,\ell) = (3,0)\)</span></p></li>
</ul>
<p>Notice how the larger values of <span class="math notranslate nohighlight">\(l\)</span> are pushed further away from the origin. This is coming from the additional force due to the fake potential.</p>
<div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (start)"></img><br></div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#answer here</span>
</pre></div>
</div>
</div>
</div>
<div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (end)"></img><br></div><p>It should also be that the different <span class="math notranslate nohighlight">\(u_{nl}(r)\)</span> at fixed <span class="math notranslate nohighlight">\(l\)</span> are orthogonal to each other.  Check this by verifying that
<span class="math notranslate nohighlight">\(u_{31} u_{21}^\dagger=0\)</span>  You can do this by doing <code class="docutils literal notranslate"><span class="pre">u31</span> <span class="pre">&#64;</span> <span class="pre">u21.T.conjugate()</span></code> where you get <code class="docutils literal notranslate"><span class="pre">u</span></code> by multiplying your radial function by <span class="math notranslate nohighlight">\(r\)</span>.</p>
<div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (start)"></img><br></div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#answer here</span>
</pre></div>
</div>
</div>
</div>
<div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (end)"></img><br></div></section>
<section id="b-hydrogen-orbitals">
<h3>b. Hydrogen Orbitals<a class="headerlink" href="#b-hydrogen-orbitals" title="Permalink to this heading">#</a></h3>
<p>We can now combine the radial wave-function with the spherical Harmonics to write down the Hydrogen orbitals</p>
<div class="math notranslate nohighlight">
\[\Psi_{nlm}(x,y,z) = R_{nl}(x,y,z)Y_{lm}(\theta,\phi)\]</div>
<p>We are going to want to evaluate these orbitals on the entire space.  Therefore, we will start by putting together a three-dimensional grid of the (x,y,z) positions.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">HydrogenGrid</span><span class="p">(</span><span class="n">g</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">numGridPoints</span><span class="o">=</span><span class="mi">50</span><span class="p">):</span>
    <span class="n">p</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">g</span><span class="p">,</span><span class="n">g</span><span class="p">,</span><span class="n">numGridPoints</span><span class="p">)</span>
    <span class="n">h</span><span class="o">=</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">h</span>
</pre></div>
</div>
<p>which you can then get the grid from by doing <code class="docutils literal notranslate"><span class="pre">x,y,z,h=HydrogenGrid(g)</span></code></p>
<p>You’ll adjust the grid length <code class="docutils literal notranslate"><span class="pre">g</span></code> depending on which orbital you’re trying to plot. This will return three three-dimensional arrays x,y, z (as well as a scalar grid-spacing h).</p>
<p>The three-dimensional array x simply has the coordinate of x at every point in (the discretized) 3D space and the three-dimensional array y has the coordinate of y at every point in (the discretized) 3D space - e.g. the analogous 2D version of this are
<span class="math notranslate nohighlight">\(x=\)</span></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[[</span><span class="o">-</span><span class="mf">8.</span> <span class="o">-</span><span class="mf">4.</span>  <span class="mf">0.</span>  <span class="mf">4.</span>  <span class="mf">8.</span><span class="p">]</span>
 <span class="p">[</span><span class="o">-</span><span class="mf">8.</span> <span class="o">-</span><span class="mf">4.</span>  <span class="mf">0.</span>  <span class="mf">4.</span>  <span class="mf">8.</span><span class="p">]</span>
 <span class="p">[</span><span class="o">-</span><span class="mf">8.</span> <span class="o">-</span><span class="mf">4.</span>  <span class="mf">0.</span>  <span class="mf">4.</span>  <span class="mf">8.</span><span class="p">]</span>
 <span class="p">[</span><span class="o">-</span><span class="mf">8.</span> <span class="o">-</span><span class="mf">4.</span>  <span class="mf">0.</span>  <span class="mf">4.</span>  <span class="mf">8.</span><span class="p">]</span>
 <span class="p">[</span><span class="o">-</span><span class="mf">8.</span> <span class="o">-</span><span class="mf">4.</span>  <span class="mf">0.</span>  <span class="mf">4.</span>  <span class="mf">8.</span><span class="p">]]</span>
</pre></div>
</div>
<p>and <span class="math notranslate nohighlight">\(y=\)</span></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[[</span><span class="o">-</span><span class="mf">8.</span> <span class="o">-</span><span class="mf">8.</span> <span class="o">-</span><span class="mf">8.</span> <span class="o">-</span><span class="mf">8.</span> <span class="o">-</span><span class="mf">8.</span><span class="p">]</span>
 <span class="p">[</span><span class="o">-</span><span class="mf">4.</span> <span class="o">-</span><span class="mf">4.</span> <span class="o">-</span><span class="mf">4.</span> <span class="o">-</span><span class="mf">4.</span> <span class="o">-</span><span class="mf">4.</span><span class="p">]</span>
 <span class="p">[</span> <span class="mf">0.</span>  <span class="mf">0.</span>  <span class="mf">0.</span>  <span class="mf">0.</span>  <span class="mf">0.</span><span class="p">]</span>
 <span class="p">[</span> <span class="mf">4.</span>  <span class="mf">4.</span>  <span class="mf">4.</span>  <span class="mf">4.</span>  <span class="mf">4.</span><span class="p">]</span>
 <span class="p">[</span> <span class="mf">8.</span>  <span class="mf">8.</span>  <span class="mf">8.</span>  <span class="mf">8.</span>  <span class="mf">8.</span><span class="p">]]</span>
</pre></div>
</div>
<p>Python generates grids like this using <code class="docutils literal notranslate"><span class="pre">np.meshgrid</span></code> (see the <code class="docutils literal notranslate"><span class="pre">HydrogenGrid</span></code> function)</p>
<p>By using these three grids, it makes it easy to produce three-dimensional grids of the values of <span class="math notranslate nohighlight">\(r\)</span> or <span class="math notranslate nohighlight">\(\theta\)</span> or <span class="math notranslate nohighlight">\(\phi\)</span>.</p>
<p>Go ahead and write a function <code class="docutils literal notranslate"><span class="pre">Cartesian2Spherical(x,y,z)</span></code> which returns three-dimensional grids of <span class="math notranslate nohighlight">\(r\)</span>, <span class="math notranslate nohighlight">\(\theta\)</span>, and <span class="math notranslate nohighlight">\(\phi\)</span> at every point in space.
Recall that</p>
<div class="math notranslate nohighlight">
\[\theta = \tan^{-1}(y/x) +\pi \]</div>
<p>(use <code class="docutils literal notranslate"><span class="pre">np.arctan2(y,x)</span></code>)</p>
<p>and</p>
<div class="math notranslate nohighlight">
\[\phi = \cos^{-1}(z/r)\]</div>
<p>You should now have access to <span class="math notranslate nohighlight">\(r,\theta,\phi\)</span> on your grid from which you can call both your radial function and spherical harmonics.  Write a function <code class="docutils literal notranslate"><span class="pre">HydrogenAtom(n,</span> <span class="pre">l,</span> <span class="pre">m,x,y,z)</span></code> which computes the hydrogen orbital on this grid and returns <code class="docutils literal notranslate"><span class="pre">psi</span></code>.</p>
<p>The spherical Harmonics is</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sp</span><span class="o">.</span><span class="n">sph_harm</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="n">theta</span><span class="p">,</span><span class="n">phi</span><span class="p">)</span>
</pre></div>
</div>
<p>where the <span class="math notranslate nohighlight">\(m\)</span> and <span class="math notranslate nohighlight">\(l\)</span> are indexing the eigenstates of the angular momentum operator. (Notice that this is backwards from how you typical think about the quantum numbers for the hydrogen atom).</p>
<p>To plot the wave-function use the following</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">PlotMe</span><span class="p">(</span><span class="n">psi</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">):</span>
    <span class="n">isosurface</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Isosurface</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span>
        <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span>
        <span class="n">z</span><span class="o">=</span><span class="n">z</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span>
        <span class="n">value</span><span class="o">=</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">psi</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span>  <span class="c1"># Use the absolute value for intensity</span>
        <span class="n">surface_count</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="c1"># Number of isosurfaces to display</span>
        <span class="n">opacity</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>  <span class="c1"># Set the opacity of the isosurface</span>
        <span class="n">surface_fill</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="n">caps</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">x_show</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">y_show</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">z_show</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="n">isosurface</span><span class="p">])</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>Plot <span class="math notranslate nohighlight">\((n,\ell,m) = (1,0,0); (2,1,0); (3,2,2); (3,2,0)\)</span> where the grid-length I used to get a good figure was</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">g</span><span class="o">=</span><span class="nb">dict</span><span class="p">()</span>
<span class="n">g</span><span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)]</span><span class="o">=</span><span class="mi">4</span>
<span class="n">g</span><span class="p">[(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)]</span><span class="o">=</span><span class="mf">7.7</span>
<span class="n">g</span><span class="p">[(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)]</span><span class="o">=</span><span class="mi">18</span>
<span class="n">g</span><span class="p">[(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">)]</span><span class="o">=</span><span class="mi">20</span>
</pre></div>
</div>
<div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (start)"></img><br></div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#answer here</span>
</pre></div>
</div>
</div>
</div>
<div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (end)"></img><br></div></section>
<section id="c-getting-the-energy-of-the-hydrogen-atom">
<h3>c. Getting the Energy of the Hydrogen Atom<a class="headerlink" href="#c-getting-the-energy-of-the-hydrogen-atom" title="Permalink to this heading">#</a></h3>
<p>Now we are going to compute the energy of the Hydrogen atom.   Recall that the Hamiltonian for the Hydrogen atom is</p>
<div class="math notranslate nohighlight">
\[ H =  -\frac{1}{2} \nabla^2 + \frac{1}{r} \]</div>
<p>where <span class="math notranslate nohighlight">\(-\nabla^2 = \partial^2/\partial x^2 + \partial^2/\partial y^2  + \partial^2/\partial z^2\)</span> and <span class="math notranslate nohighlight">\(r\)</span> is the distance between the nucleus and the electron.</p>
<p>Let’s figure out how to compute each of these terms.</p>
<p>This second term can be computed by taking the integral</p>
<div class="math notranslate nohighlight">
\[ \int \Psi(x,y,z) \left(-\frac{1}{r}\right) \Psi^*(x,y,z) dx dx dz \]</div>
<p>If we evaluate our wave-function <code class="docutils literal notranslate"><span class="pre">psi</span></code> on the grid (which is how we got our orbitals that we visualize above), then we simply multiply these three terms, sum them up (<code class="docutils literal notranslate"><span class="pre">np.sum</span></code>) and then multiply by our grid spacing cubed.</p>
<p>For the <span class="math notranslate nohighlight">\((n,l,m)=(1,0,0)\)</span> you should get a potential Energy of  -0.9897509703021152 using the following grid <code class="docutils literal notranslate"><span class="pre">x,y,z,delta_x=HydrogenGrid(20,200)</span></code></p>
<p>Implement this function and make sure you get the correct energy.</p>
<div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (start)"></img><br></div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#answer here</span>
</pre></div>
</div>
</div>
</div>
<div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (end)"></img><br></div><p>Now we need to get the next term</p>
<div class="math notranslate nohighlight">
\[ -\frac{1}{2} \int \Psi^*(x,y,z)\frac{\partial^2}{\partial x^2} \Psi(x,y,z) dx dx dz \]</div>
<p>We can compute this by finite differences.  The standard formula for the second derivative is</p>
<div class="math notranslate nohighlight">
\[
\frac{\partial^2}{\partial x^2} = \frac{f(x+dx)+f(x-dx)-2f(x)}{dx^2}
\]</div>
<p>Write a function <code class="docutils literal notranslate"><span class="pre">Laplacian(n,l,m)</span></code> which calls <code class="docutils literal notranslate"><span class="pre">HydrogenWaveFunction</span></code> three times (per direction) returning the laplacian; for example for the x-direction it calls  <code class="docutils literal notranslate"><span class="pre">x+dx</span></code>, <code class="docutils literal notranslate"><span class="pre">x-dx</span></code>, and <code class="docutils literal notranslate"><span class="pre">x</span></code>. For <code class="docutils literal notranslate"><span class="pre">dx</span></code> use 1e-3.</p>
<p>Compute the kinetic energy of the <span class="math notranslate nohighlight">\((n,l,m)=(1,0,0)\)</span> state.  You should get 0.4897835961971023 total with each of the three kinetic terms being the same (because of the symmetry of this state)</p>
<p>Now sum up the kinetic and potential energies and multiply by 27.2 to get it into eV.  Verify that you get the right answer for the (1,0,0) term.  Also compute the energies for the (2,0,0), (2,1,0), (2,1,1) and (3,2,1) terms.  Check that each of them are close to the known value.</p>
<div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (start)"></img><br></div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#answer here</span>
</pre></div>
</div>
</div>
</div>
<div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (end)"></img><br></div></section>
</section>
<section id="exercise-2-solving-the-hydrogen-atom-radial-equation-numerically">
<h2>Exercise 2. Solving the Hydrogen Atom Radial Equation Numerically<a class="headerlink" href="#exercise-2-solving-the-hydrogen-atom-radial-equation-numerically" title="Permalink to this heading">#</a></h2>
<p>Recall that the Hydrogen atom Hamiltonian is</p>
<div class="math notranslate nohighlight">
\[H =  -\nabla^2 - \frac{1}{r} \]</div>
<p>We solve the hydrogen atom using separation of variables eventually finding that</p>
<div class="math notranslate nohighlight">
\[\Psi(R,\theta,\phi) = R_{nl}(r) Y_{lm}(\theta,\phi)\]</div>
<p>where <span class="math notranslate nohighlight">\(R_{nl}(r) = u(r)/r\)</span> and <span class="math notranslate nohighlight">\(u(r)\)</span> obeys the raidial eigenvalue equation</p>
<div class="math notranslate nohighlight">
\[ \left[-\frac{1}{2}\left(\frac{d^2}{dr^2} - \frac{l(l+1)}{r^2}  \right) - \frac{1}{r} \right] u(r) = E u(r)\]</div>
<p>which we can write as</p>
<div class="math notranslate nohighlight">
\[H_{eff} u(r) = E u(r)\]</div>
<p>This problem looks a lot like the particle in the box.   We can think of <span class="math notranslate nohighlight">\(r\)</span> here just like the <span class="math notranslate nohighlight">\(x\)</span> coordinate.  Then the Hamiltonian has three terms:</p>
<ul class="simple">
<li><p>the standard kinetic energy term</p></li>
<li><p>a potential term coming from the angular momentum</p></li>
<li><p>a potential term coming from the coulomb potential.</p></li>
</ul>
<p>To solve this analytically required a significant amount of work.  We will see that solving it numerically is relatively straightforward. For each of the terms in <span class="math notranslate nohighlight">\(H_{eff}\)</span> we need to write out a <span class="math notranslate nohighlight">\(N \times N\)</span> Hamiltonian matrix  (where <span class="math notranslate nohighlight">\(N\)</span> is the number of points in our grid which discretizes space).</p>
<section id="a-the-kinetic-term">
<h3>a. The Kinetic Term<a class="headerlink" href="#a-the-kinetic-term" title="Permalink to this heading">#</a></h3>
<p>We will start by working with a discretized grid which is <span class="math notranslate nohighlight">\(N=200\)</span> points defined by</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">N</span><span class="o">=</span><span class="mi">200</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">40</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>Later to actually get accurate answers, we are going to want to increase <span class="math notranslate nohighlight">\(N\)</span> which will actually require us to make some changes (moving to sparse matrices) but let’s start with the smaller dense matrices.</p>
<p>We are building <span class="math notranslate nohighlight">\(N \times N\)</span> matrices where each row (respectively column) corresponds to a values of <span class="math notranslate nohighlight">\(r\)</span> on the grid - i.e. the “third” row corresponds to r[2] and the “fourth” column corresponds to the value of r[3].</p>
<p>Let’s start with the term</p>
<div class="math notranslate nohighlight">
\[\frac{d^2}{dr^2} = \frac{2 f(r) - f(r+dr ) - f(r-dr)}{dr^2} \]</div>
<p>As a matrix this means:</p>
<ul class="simple">
<li><p>the elements that connect the r’th column to the r’th row should get a <span class="math notranslate nohighlight">\(2/dr^2\)</span>.  This is just the diagonal of the matrix</p></li>
<li><p>the elements that connect the (r+1)’st column to the r’th row should get a <span class="math notranslate nohighlight">\(-1/dr^2\)</span>. This is just one row above the diagonal</p></li>
<li><p>the elements that connect the (r-1)’st column to the r’th row should get a <span class="math notranslate nohighlight">\(-1/dr^2\)</span>. This is just one row below the diagonal.</p></li>
</ul>
<p>Write a function <code class="docutils literal notranslate"><span class="pre">Laplacian(r)</span></code> which takes the grid <code class="docutils literal notranslate"><span class="pre">r</span></code> and returns a matrix corresponding to the second derivative.   You will find the <code class="docutils literal notranslate"><span class="pre">np.diag</span></code> function useful (even the off-diagonal term can be built using it - look at the documentation!).  You should essentially be able to build this matrix in three such function calls.</p>
<p>Working in units where <span class="math notranslate nohighlight">\(\hbar =1\)</span> and <span class="math notranslate nohighlight">\(m=1\)</span>, go ahead and compute the full kinetic term.   To diagonalize a matrix, you can call <code class="docutils literal notranslate"><span class="pre">e,v=np.linalg.eigh(L)</span></code>.  Verify that the lowest four energies are [0.00305358 0.01221356 0.02747771 0.04884231].</p>
<div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (start)"></img><br></div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#answer here</span>
</pre></div>
</div>
</div>
</div>
<div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (end)"></img><br></div></section>
<section id="b-the-potential-terms">
<h3>b. The potential terms<a class="headerlink" href="#b-the-potential-terms" title="Permalink to this heading">#</a></h3>
<p>The two potential terms are a function of <span class="math notranslate nohighlight">\(r\)</span> and ther matrices for these two terms therefore only connect the r’th row to the r’th column. This means both additional terms only exist on the diagonal.   Build a function <code class="docutils literal notranslate"><span class="pre">V(r,l)</span></code> that takes the <code class="docutils literal notranslate"><span class="pre">r</span></code> grid and returns the matrix corresponding to the potential</p>
<div class="math notranslate nohighlight">
\[V(r,l) = \frac{l(l+1)}{2r^2} - \frac{1}{r}\]</div>
<p>Again use <code class="docutils literal notranslate"><span class="pre">np.diag</span></code></p>
<div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (start)"></img><br></div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#answer here</span>
</pre></div>
</div>
</div>
</div>
<div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (end)"></img><br></div></section>
<section id="c-putting-it-together">
<h3>c. Putting it together<a class="headerlink" href="#c-putting-it-together" title="Permalink to this heading">#</a></h3>
<p>Now we simply want to add the full Hamiltonian matrix together and diagonalize it using <code class="docutils literal notranslate"><span class="pre">e,v=np.linalg.eigh(H)</span></code></p>
<p>Both print and plot the lowest 6 energies - <code class="docutils literal notranslate"><span class="pre">plt.plot(e[0:6]*27.2)</span></code>.  Also on your plot make some straight lines - <code class="docutils literal notranslate"><span class="pre">plt.axhline(the_energy)</span></code> where the energies for the n’th eignenstate should be - i.e. <span class="math notranslate nohighlight">\(-13.6/n^2\)</span>.  How close are you getting?</p>
<p>Also plot the lowest three eigenstates and see if the radial functions match the ones from above.  To normalize the plot correctly you have to divide your eigenvectors by <span class="math notranslate nohighlight">\(\sqrt{h}\)</span>.</p>
<div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (start)"></img><br></div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#answer here</span>
</pre></div>
</div>
</div>
</div>
<div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (end)"></img><br></div></section>
<section id="d-finer-grids">
<h3>d. Finer Grids<a class="headerlink" href="#d-finer-grids" title="Permalink to this heading">#</a></h3>
<p>We are not getting an accuracy as high as we might desire.  What we need is a better grid: finer and going out to larger <span class="math notranslate nohighlight">\(r\)</span>.    Unfortunately, if there are more grid points, the matrix gets larger and using dense matrices and solving for all the eigenstates becomes intractable.  Instead we need to work with sparse matrices.</p>
<p>To do this, you need to do the following:</p>
<ul class="simple">
<li><p>Change <code class="docutils literal notranslate"><span class="pre">V</span></code> and <code class="docutils literal notranslate"><span class="pre">Laplacian</span></code> to return sparse matrices.  You can do this by just having the return be <code class="docutils literal notranslate"><span class="pre">return</span>&#160; <span class="pre">scipy.sparse.csr_matrix(oldMatrix)</span></code></p></li>
<li><p>When you diagonalize, take <code class="docutils literal notranslate"><span class="pre">e,v=scipy.sparse.linalg.eigsh(H,k=6,which='SA')</span></code> This will give you sparse versions of the lowest six eigenstates.</p></li>
</ul>
<p>Use now a grid of <span class="math notranslate nohighlight">\(N=4000\)</span> from <span class="math notranslate nohighlight">\(L=-60\)</span> to <span class="math notranslate nohighlight">\(L=60\)</span></p>
<p>Go ahead and plot the same curves as above and verify you get more reasonable results.</p>
<div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (start)"></img><br></div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#answer here</span>
</pre></div>
</div>
</div>
</div>
<div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (end)"></img><br></div></section>
</section>
<section id="exercise-3-hydrogen-atom-on-a-grid">
<h2>Exercise 3. Hydrogen Atom on a Grid<a class="headerlink" href="#exercise-3-hydrogen-atom-on-a-grid" title="Permalink to this heading">#</a></h2>
<p>So far we’ve plotted the orbitals for the Hydrogen atom by</p>
<ul class="simple">
<li><p>using the formula for the orbitals that one derives analytically</p></li>
<li><p>using the radial equation you derived analytically (along with the spherical harmonics)</p></li>
</ul>
<p>In both cases, we (somebody?) had to do a lot of analytic work to get something that we then worked with computationally.  Now we just want to envision a situation where we have a Hamiltonian and want to directly work with and diagonalize this on a grid.</p>
<section id="a-the-hamiltonian">
<h3>a. The Hamiltonian<a class="headerlink" href="#a-the-hamiltonian" title="Permalink to this heading">#</a></h3>
<p>Our goal here is to be able to solve for the eigenstates and eigenvalues of the Hydrogen atom.</p>
<p>The hydrogen atom has a single electron and a Hamiltonian of</p>
<div class="math notranslate nohighlight">
\[H =  -\frac{1}{2}\nabla^2 + V(R) \]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[V(R) = -\frac{1}{R}\]</div>
<p>where <span class="math notranslate nohighlight">\(R\)</span> is the distance between the proton and electron of the Hydrogen atom.</p>
<p>Let’s learn some things to put this together:</p>
<p>First recall that <span class="math notranslate nohighlight">\(\nabla^2 = \frac{d^2}{dx^2}+\frac{d^2}{dy^2}+ \frac{d^2}{dz^2}\)</span>.  We need to generate a matrix for this laplacian.</p>
<p>There’s something a little subtle here.  <span class="math notranslate nohighlight">\(d^2/dx^2\)</span> looks like the same term that we saw for the particle in the box but it now needs to exist over three-dimensions.   If <span class="math notranslate nohighlight">\(L\)</span> was the one-dimensional derivative, we instead now write this as <span class="math notranslate nohighlight">\(L \otimes I \otimes I\)</span> where <span class="math notranslate nohighlight">\(I\)</span> is the identity of the same size matrix.</p>
<p>Let’s think how large a matrix we are making here.  We have a matrix that is number of grid points <span class="math notranslate nohighlight">\(\times\)</span> grid points.  If we use 80 grid points in every direction, we get a matrix of size <span class="math notranslate nohighlight">\(80^3 \times 80^3\)</span> or <span class="math notranslate nohighlight">\(512,000 \times 512,000\)</span>.  This is much too large to be densely represented on a computer. To get around this, we are going to have to use sparse matrices.  The trick here is to</p>
<ul class="simple">
<li><p>first take your one-dimensional Laplacian (call it <code class="docutils literal notranslate"><span class="pre">L</span></code>) and turn it into a sparse matrix (i.e. <code class="docutils literal notranslate"><span class="pre">scipy.sparse.lil_matrix(L)</span></code>) and</p></li>
<li><p>then when you produce your three-dimensional laplacian make sure that you do a kroneker product - i.e. <code class="docutils literal notranslate"><span class="pre">scipy.sparse.kron(scipy.sparse.kron(L,I),I)</span></code>
These two steps will give you <span class="math notranslate nohighlight">\(\frac{d^2}{dx^2}\)</span>.  Then you need to also get <span class="math notranslate nohighlight">\(\frac{d^2}{dy^2}\)</span> and <span class="math notranslate nohighlight">\(\frac{d^2}{dz^2}\)</span>.  Go ahead and generate the matrix then for <span class="math notranslate nohighlight">\(\nabla^2\)</span> (make sure in your laplacian you rememember to divide by <span class="math notranslate nohighlight">\(1/h^2\)</span> where <span class="math notranslate nohighlight">\(h\)</span> is the grid spacing).</p></li>
</ul>
<p>Let’s check that our Laplacian is giving us the correct thing.  We should be able to diagonalize it and get the energies for a particle in a three-dimensional box.</p>
<p>You can’t actually afford to get all the eigenvalues of such a large matrix.  Instead, we are going to only get the first couple.  To do this, you can use <code class="docutils literal notranslate"><span class="pre">e,v=scipy.sparse.linalg.eigsh(-0.5*L,</span> <span class="pre">which='SA')</span></code> and show that the first few energies are correct for a grid</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">HydrogenGrid</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="n">numGridPoints</span><span class="o">=</span><span class="mi">80</span><span class="p">)</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">which='SA'</span></code> is important to get the lowest energies.</p>
<div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (end)"></img><br></div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#answer here</span>
</pre></div>
</div>
</div>
</div>
<div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (end)"></img><br></div><p>After you have your laplacian in place, you want to generate the Coulomb potential piece of your Hamiltonian (<span class="math notranslate nohighlight">\(1/R\)</span>) on a grid.</p>
<!-- 
You want to get a three-dimensional grid 
`r2=x*x+y*y+z*z`.   You essentially want three-dimensional versions of the following:
$x=$
```
[[-8. -4.  0.  4.  8.]
 [-8. -4.  0.  4.  8.]
 [-8. -4.  0.  4.  8.]
 [-8. -4.  0.  4.  8.]
 [-8. -4.  0.  4.  8.]]
 ```

and $y=$
```
[[-8. -8. -8. -8. -8.]
 [-4. -4. -4. -4. -4.]
 [ 0.  0.  0.  0.  0.]
 [ 4.  4.  4.  4.  4.]
 [ 8.  8.  8.  8.  8.]]
```

You can generate these sort of matrices using the `np.meshgrid` function.  This can be done like
```
p = np.linspace(-12, 12, g);         #% one dimensiton space lattice
[X, Y, Z] = np.meshgrid(p, p, p);  #% three dimension space lattice
```

From this it should be straightforward to produce $R$ as a three-dimensional grid.  -->
<p>The potential <span class="math notranslate nohighlight">\(V(R)\)</span> is a diagonal term of the Hamiltonian (i.e. it’s on the diagonal of the matrix).  First compute the potential <span class="math notranslate nohighlight">\(V(R)\)</span> on your three-dimensional grid (call it <code class="docutils literal notranslate"><span class="pre">Vext</span></code>).  To put it on the diagonal, you need to reshape your three-dimensional grid onto a one-dimensional vector which you can then make the diagonal of your matrix</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="n">m</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">Vext</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
  <span class="n">Vext</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">Vext</span><span class="p">,</span><span class="n">m</span><span class="o">*</span><span class="n">m</span><span class="o">*</span><span class="n">m</span><span class="p">)</span>
  <span class="n">potential</span><span class="o">=</span><span class="n">scipy</span><span class="o">.</span><span class="n">sparse</span><span class="o">.</span><span class="n">diags</span><span class="p">(</span><span class="n">Vext</span><span class="p">)</span>
</pre></div>
</div>
<p>Write a function <code class="docutils literal notranslate"><span class="pre">ExternalPotential</span></code> which generates this matrix.</p>
<p>You now have your laplacian term and your potential term.  You can add these two terms together to get your full Hamiltonian.</p>
<div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (start)"></img><br></div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#answer here</span>
</pre></div>
</div>
</div>
</div>
<div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (end)"></img><br></div></section>
<section id="b-eigenvalues">
<h3>b. Eigenvalues<a class="headerlink" href="#b-eigenvalues" title="Permalink to this heading">#</a></h3>
<p>Diagonalize your full Hamiltonian using <code class="docutils literal notranslate"><span class="pre">scipy.sparse.linalg.eigsh</span></code> on your <span class="math notranslate nohighlight">\(12 \times 12 \times 12\)</span> grid.</p>
<p>We would like to see that you get the expected eigenenergies and eigenstates.</p>
<p>Recall the standard hydrogen orbitals from chemistry each with an energy of <span class="math notranslate nohighlight">\(-13.6/n^2\)</span> eV</p>
<p>The lowest 6 energies for the Hydrogen atom should be</p>
<ul class="simple">
<li><p>1s</p></li>
<li><p>2s</p></li>
<li><p>2px, 2py, 2pz</p></li>
<li><p>3s</p></li>
</ul>
<p>Let’s start with looking at the energies of the 1s, 2s, and 3s states which we expect it to be -13.6 eV, -13.6/4 eV and -13.6/9 eV respectively.  Obviously because we are using a grid, we aren’t going to get the exact answer. But as we increase the grid size we should get closer and closer to the true answer.  Starting with 20 grid points per direction and increasing the grid in units of 20 up to 100 grid points per direction, graph the energy of these three eigenstates as a function of number of grid points per direction. Also draw horizontal lines at the expected value of the eigenstates.  You should see the energies approach the target energies at large grid-size.  <em>Hint: Your g=20 energy for 1s should be -10.71473301</em>.  (There are some eigenstates where you need to increase the size of the grid to capture the full wave-function)</p>
<p><strong>Note:</strong>. You need to be careful about units.  To convert into eV you have to multiply your energy by 27.21.</p>
<div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (start)"></img><br></div><div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#answer here</span>
</pre></div>
</div>
</div>
</details>
</div>
<div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (end)"></img><br></div></section>
<section id="c-eigenvectors">
<h3>c. Eigenvectors<a class="headerlink" href="#c-eigenvectors" title="Permalink to this heading">#</a></h3>
<p>Now we can also look at the eigenstates.  For this section, let’s use a grid with 80 points.</p>
<p>Let’s start by looking at the s-states.  First, we will make some two-dimensional slices of the three-dimensional wave-functions we’ve found.  To get your 2d visualization, you first need to reshape your wave-function into a 3d grid - if you have a <span class="math notranslate nohighlight">\(80 \times 80 \times 80\)</span> grid this can be done for the <span class="math notranslate nohighlight">\(i\)</span> th eigenstate by doing <code class="docutils literal notranslate"><span class="pre">A=psi[:,i].reshape(80,80,80)</span></code>.   Now you can go ahead and plot it by <code class="docutils literal notranslate"><span class="pre">plt.matshow(A[40,:,:])</span></code> where 40 is the slice that you want.  You probably want to use <code class="docutils literal notranslate"><span class="pre">plt.colorbar()</span></code> so you can see the magnitude and sign of things.</p>
<p>If you look at the 0 (1s),1 (2s) or 5 (3s) eigenstate you will find that it should have a clear “S” character - symmetric around the origin.   (This ordering of eigentstates )</p>
<p>You can also graph the probability density as a function of the radius.  You could average but because it is symmetric the easiest thing to do is just plot a one dimensional line starting at the origin.  To match up with earlier results, actually we’d like to plot not the radial function <span class="math notranslate nohighlight">\(|R_{nl}(r)|^2\)</span> but <span class="math notranslate nohighlight">\(|u_{nl}(r)|^2\)</span> so multiply by <span class="math notranslate nohighlight">\(r\)</span> - i.e. <code class="docutils literal notranslate"><span class="pre">plt.plot(r,r*A[40,40,40:])</span></code>.  Notice we are starting at <code class="docutils literal notranslate"><span class="pre">40:</span></code> for that last term because that’s where zero starts.  For the different shells, count how many nodes you see (i.e. places where the probability density goes to zero).  To normalize you have to divide by <span class="math notranslate nohighlight">\(1/(4\pi\sqrt{h})\)</span></p>
<div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (start)"></img><br></div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#answer here</span>
</pre></div>
</div>
</div>
</div>
<div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (end)"></img><br></div><p>You can also look at the 2’nd eigenstate (and third and fourth) eigenstate on a 2d plot.  This should show clearly the p-character of your state.</p>
<div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (start)"></img><br></div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#answer here</span>
</pre></div>
</div>
</div>
</div>
<div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (end)"></img><br></div></section>
<section id="c-three-dimensional-plots">
<h3>c.  Three-dimensional plots<a class="headerlink" href="#c-three-dimensional-plots" title="Permalink to this heading">#</a></h3>
<p>Now we’d like to make some three-dimensional plots.</p>
<p>Make some three-dimensional plots.   To do this, you need to put your wave-function back on a grid - i.e. psi[:,i].reshape(80,80,80).  Then use your <code class="docutils literal notranslate"><span class="pre">PlotMe</span></code> function from above.   Compare these orbitals to the ones you got by directly plotting the analytic formula.</p>
<div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (start)"></img><br></div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#answer here</span>
</pre></div>
</div>
</div>
</div>
<div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (end)"></img><br></div></section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="HarmonicOscillator.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Harmonic Oscillator</p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-1-plotting-the-hydrogen-atom-orbitals">Exercise 1.  Plotting the Hydrogen Atom Orbitals</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-radial-function">a. Radial Function</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#b-hydrogen-orbitals">b. Hydrogen Orbitals</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#c-getting-the-energy-of-the-hydrogen-atom">c. Getting the Energy of the Hydrogen Atom</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-2-solving-the-hydrogen-atom-radial-equation-numerically">Exercise 2. Solving the Hydrogen Atom Radial Equation Numerically</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-the-kinetic-term">a. The Kinetic Term</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#b-the-potential-terms">b. The potential terms</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#c-putting-it-together">c. Putting it together</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#d-finer-grids">d. Finer Grids</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-3-hydrogen-atom-on-a-grid">Exercise 3. Hydrogen Atom on a Grid</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-the-hamiltonian">a. The Hamiltonian</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#b-eigenvalues">b. Eigenvalues</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#c-eigenvectors">c. Eigenvectors</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#c-three-dimensional-plots">c.  Three-dimensional plots</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Bryan Clark
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=5b4479735964841361fd"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>