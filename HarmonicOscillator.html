
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Harmonic Oscillator and the Uncertainty Principle &#8212; Computation in Quantum Mechanics  (for Phys486)# The title of the book. Will be placed in the left navbar.</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'HarmonicOscillator';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Hydrogen Atom" href="Hydrogen.html" />
    <link rel="prev" title="Particle with a Finite Potential" href="ParticleInAFiniteWell.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="Computation in Quantum Mechanics  (for Phys486)# The title of the book. Will be placed in the left navbar. - Home"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="Computation in Quantum Mechanics  (for Phys486)# The title of the book. Will be placed in the left navbar. - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Quantum Mechanics
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="ParticleInABox.html">Particle in a Box</a></li>
<li class="toctree-l1"><a class="reference internal" href="ParticleInAFiniteWell.html">Particle with a Finite Potential</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Harmonic Oscillator and the Uncertainty Principle</a></li>
<li class="toctree-l1"><a class="reference internal" href="Hydrogen.html">Hydrogen Atom</a></li>
<li class="toctree-l1"><a class="reference internal" href="PerturbationTheory.html">Perturbation Theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="RabiOscillations.html">Rabi Oscillations</a></li>
<li class="toctree-l1"><a class="reference internal" href="VMC5.html">Variational Monte Carlo</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/illinois-compphys/QM/blob/main/quantum_mechanics/HarmonicOscillator.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Colab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Colab logo" src="_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/HarmonicOscillator.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Harmonic Oscillator and the Uncertainty Principle</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-1-the-uncertainty-principle">Exercise 1.  The Uncertainty Principle</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-the-fourier-basis">a. The Fourier Basis</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#b-measuring-uncertainty">b. Measuring Uncertainty</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#c-minimizing-uncertainty">c. Minimizing Uncertainty</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#d-coherent-states">d. Coherent States</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#e-not-coherent-states">e.  Not coherent states</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-2-harmonic-oscillator-in-real-space">Exercise 2. Harmonic Oscillator in Real Space</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-hamiltonian-and-eigenvalues">a. Hamiltonian and Eigenvalues</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#b-eigenstates">b.  Eigenstates</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#c-dynamics-and-ehrenfest-theorem">c. Dynamics and Ehrenfest theorem</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">d. Coherent States</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-3-raising-and-lowering-operators">Exercise 3. Raising and Lowering Operators</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-raising-and-lowering-operators">a. Raising and Lowering Operators</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#b-verifying-the-norms-and-number-operators">b. Verifying the norms and number operators</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#c-write-it-in-the-basis-of-number-operators">c.  Write it in the basis of number operators</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#d-warts">d. Warts</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="harmonic-oscillator-and-the-uncertainty-principle">
<h1>Harmonic Oscillator and the Uncertainty Principle<a class="headerlink" href="#harmonic-oscillator-and-the-uncertainty-principle" title="Link to this heading">#</a></h1>
<ul class="simple">
<li><p><strong>Author:</strong></p></li>
<li><p><strong>Date:</strong></p></li>
<li><p><strong>Time spent on this assignment:</strong></p></li>
</ul>
<p>Our goal in this assignment is to look at and think about the simple Harmonic oscillator.</p>
<div class="cell tag_hide-cell docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell content</p>
<p class="expanded admonition-title">Hide code cell content</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">scipy</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">math</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.animation</span><span class="w"> </span><span class="kn">import</span> <span class="n">FuncAnimation</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">IPython.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">HTML</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy.polynomial.hermite</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">Herm</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">math</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">scipy.optimize</span>


<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.animation</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">animation</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">IPython.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">HTML</span>
<span class="k">def</span><span class="w"> </span><span class="nf">resetMe</span><span class="p">(</span><span class="n">keepList</span><span class="o">=</span><span class="p">[]):</span>
    <span class="n">ll</span><span class="o">=%</span><span class="k">who_ls</span>
    <span class="n">keepList</span><span class="o">=</span><span class="n">keepList</span><span class="o">+</span><span class="p">[</span><span class="s1">&#39;FuncAnimation&#39;</span><span class="p">,</span><span class="s1">&#39;Herm&#39;</span><span class="p">,</span><span class="s1">&#39;HTML&#39;</span><span class="p">,</span><span class="s1">&#39;resetMe&#39;</span><span class="p">,</span><span class="s1">&#39;scipy&#39;</span><span class="p">,</span><span class="s1">&#39;np&#39;</span><span class="p">,</span><span class="s1">&#39;plt&#39;</span><span class="p">,</span><span class="s1">&#39;math&#39;</span><span class="p">,</span><span class="s1">&#39;jax&#39;</span><span class="p">,</span><span class="s1">&#39;jnp&#39;</span><span class="p">,</span><span class="s1">&#39;jit&#39;</span><span class="p">,</span><span class="s1">&#39;grad&#39;</span><span class="p">,</span><span class="s1">&#39;HTML&#39;</span><span class="p">,</span><span class="s1">&#39;animation&#39;</span><span class="p">,</span><span class="s1">&#39;animateMe_singlePendula&#39;</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">iiii</span> <span class="ow">in</span> <span class="n">keepList</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">iiii</span> <span class="ow">in</span> <span class="n">ll</span><span class="p">:</span>
            <span class="n">ll</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">iiii</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">iiii</span> <span class="ow">in</span> <span class="n">ll</span><span class="p">:</span>
        <span class="n">jjjj</span><span class="o">=</span><span class="s2">&quot;^&quot;</span><span class="o">+</span><span class="n">iiii</span><span class="o">+</span><span class="s2">&quot;$&quot;</span>
        <span class="o">%</span><span class="k">reset_selective</span> -f {jjjj}
    <span class="n">ll</span><span class="o">=%</span><span class="k">who_ls</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;font.size&quot;</span><span class="p">:</span> <span class="mi">14</span><span class="p">})</span>
    <span class="k">return</span>
<span class="n">resetMe</span><span class="p">()</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">datetime</span><span class="p">;</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">line</span> <span class="mi">2</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="ne">----&gt; </span><span class="mi">2</span> <span class="kn">import</span><span class="w"> </span><span class="nn">scipy</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="kn">import</span><span class="w"> </span><span class="nn">math</span>

<span class="ne">ModuleNotFoundError</span>: No module named &#39;scipy&#39;
</pre></div>
</div>
</div>
</details>
</div>
<p>In this assignment, we will consistently use grids and observables that we will set up in this way. This is very similar to how you set things for the particle in the box assignment.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">SetupGrid</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="n">delta_x</span><span class="p">):</span>
    <span class="n">ns</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">int</span><span class="p">((</span><span class="n">L</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">delta_x</span><span class="p">)</span><span class="o">//</span><span class="n">delta_x</span><span class="p">)))</span>
    <span class="n">xs</span><span class="o">=</span><span class="n">ns</span><span class="o">*</span><span class="n">delta_x</span><span class="o">-</span><span class="n">L</span><span class="o">/</span><span class="mi">2</span>
    <span class="k">return</span> <span class="n">xs</span>

<span class="k">def</span><span class="w"> </span><span class="nf">SetupObservables</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span><span class="n">delta_x</span><span class="p">):</span>
    <span class="n">X</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span>
    <span class="n">P</span><span class="o">=</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">([</span><span class="mf">1.</span><span class="n">j</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">delta_x</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)],</span><span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">([</span><span class="o">-</span><span class="mf">1.</span><span class="n">j</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">delta_x</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)],</span><span class="n">k</span><span class="o">=-</span><span class="mi">1</span><span class="p">))</span>

    <span class="n">P2</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xs</span><span class="p">)):</span>
        <span class="n">P2</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="mf">2.0</span><span class="o">/</span><span class="n">delta_x</span><span class="o">**</span><span class="mi">2</span>
        <span class="k">if</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="o">&lt;</span><span class="nb">len</span><span class="p">(</span><span class="n">xs</span><span class="p">):</span>
            <span class="n">P2</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">=-</span><span class="mf">1.0</span><span class="o">/</span><span class="n">delta_x</span><span class="o">**</span><span class="mi">2</span>
            <span class="n">P2</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">]</span><span class="o">=-</span><span class="mf">1.0</span><span class="o">/</span><span class="n">delta_x</span><span class="o">**</span><span class="mi">2</span>  
    <span class="k">return</span> <span class="n">X</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="n">P2</span>


<span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">max_value</span><span class="p">,</span><span class="n">skip</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">cla</span><span class="p">()</span>  <span class="c1"># Clear the current plot</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">arrays</span><span class="p">[::</span><span class="n">skip</span><span class="p">][</span><span class="n">frame</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>  <span class="c1"># Plot the current array</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">arrays</span><span class="p">[::</span><span class="n">skip</span><span class="p">][</span><span class="n">frame</span><span class="p">]</span><span class="nd">@X@arrays</span><span class="p">[::</span><span class="n">skip</span><span class="p">][</span><span class="n">frame</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">conjugate</span><span class="p">())</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">max_value</span><span class="p">)</span>  <span class="c1"># Set the y-axis limit</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Value&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Frame </span><span class="si">{</span><span class="n">skip</span><span class="o">*</span><span class="n">frame</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">arrays</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>  <span class="c1"># Display the frame number</span>
</pre></div>
</div>
</div>
</div>
<section id="exercise-1-the-uncertainty-principle">
<h2>Exercise 1.  The Uncertainty Principle<a class="headerlink" href="#exercise-1-the-uncertainty-principle" title="Link to this heading">#</a></h2>
<p>In this exercise, we’d like to think about the uncertainty principle.</p>
<section id="a-the-fourier-basis">
<h3>a. The Fourier Basis<a class="headerlink" href="#a-the-fourier-basis" title="Link to this heading">#</a></h3>
<p>The uncertainty principle tells us that you can’t simultaneously know a particle’s position and momentum.  It’s typically quantified as</p>
<div class="math notranslate nohighlight">
\[ \Delta X \Delta P &gt; \frac{1}{2} \]</div>
<p>Let’s think for a moment about what it means to be certain or uncertain about a particles position.  If you are uncertain about the position of a particle, what this means is that if you measure that particle many times, you get very different answers for the <span class="math notranslate nohighlight">\(x\)</span> position of a particle.   If you are certain about the position of a particle this means that most measurements come out concentrated in a particular region so even before measuring, we could feel reasonably certain where the particle is in <span class="math notranslate nohighlight">\(x\)</span>.</p>
<p>Here is an example of a wave-function which you are reasonably certain about it’s position:</p>
<div class="math notranslate nohighlight">
\[\Psi = N \exp[-\alpha (x-4)^6]\]</div>
<p>where <span class="math notranslate nohighlight">\(N\)</span> is the normalization and <span class="math notranslate nohighlight">\(\alpha=100\)</span>.</p>
<p>After setting up your grid and observables:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">delta_x</span><span class="o">=</span><span class="mf">0.1</span>
<span class="n">xs</span><span class="o">=</span><span class="n">SetupGrid</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="n">delta_x</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="n">P2</span><span class="o">=</span><span class="n">SetupObservables</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span><span class="n">delta_x</span><span class="p">)</span>
</pre></div>
</div>
<p>go ahead and plot the probability (absolute value squared of the wave-function) of getting different <span class="math notranslate nohighlight">\(x\)</span> values for this wave-function rememembering to label the x-axis as <code class="docutils literal notranslate"><span class="pre">plt.xlabel(&quot;x&quot;)</span></code> and the y-axis as <code class="docutils literal notranslate"><span class="pre">plt.ylabel(&quot;probability&quot;)</span></code>.   From this plot, you should be able to see that if you measure <span class="math notranslate nohighlight">\(x\)</span> over and over again if will always be getting an answer somewhat around 4.</p>
<div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (start)"></img><br></div><div class="cell tag_hide-cell docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell content</p>
<p class="expanded admonition-title">Hide code cell content</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># answer here</span>
</pre></div>
</div>
</div>
</details>
</div>
<div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (end)"></img><br></div><p>We are now hoping that there’s also a pretty narrow range of where the particle can be in momentum <span class="math notranslate nohighlight">\(P\)</span> - i.e. if we measure the momentum over and over again would we get essentially the same value.  It’s hard to look at our plot and figure this out at the moment.  That’s because the wave-function is currently plotted in the x-basis.  We could also plot it in the momentum basis.  If we did that, then we could look at the wave-function squared and see how spread out it is in momentum (and so whether I would expect to get the same momentum if I measured it).</p>
<p>So we’d like to replot the wave-function as a function of <span class="math notranslate nohighlight">\(p\)</span> and not <span class="math notranslate nohighlight">\(x\)</span>.  Mind you, this is the same wave-function.  It’s just a different way of representing it.  If I show you a curve and I don’t tell label the axis so you know whether you are in the <span class="math notranslate nohighlight">\(x\)</span> basis or <span class="math notranslate nohighlight">\(p\)</span> basis, you don’t really know what you’re looking at.</p>
<p>To change a basis you mutiply by a unitary matrix that corresponds to that basis change.  We need the unitary matrix that multiplies a wave-function in the x-basis and converts it to the p-basis.  Then we can plot it in the p-basis.
You can get this unitary (along with the basis of p-points) by doing</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">MomentumBasis</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="n">delta_x</span><span class="p">):</span>
    <span class="n">ns</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">int</span><span class="p">((</span><span class="n">L</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">delta_x</span><span class="p">)</span><span class="o">//</span><span class="n">delta_x</span><span class="p">)))</span>
    <span class="n">xs</span><span class="o">=</span><span class="n">ns</span><span class="o">*</span><span class="n">delta_x</span><span class="o">-</span><span class="n">L</span><span class="o">/</span><span class="mi">2</span>
    <span class="n">ks</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ns</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="p">(</span><span class="n">ns</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
    <span class="n">l</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">ks</span><span class="p">)</span>
    <span class="n">ks</span><span class="p">[</span><span class="n">l</span><span class="o">//</span><span class="mi">2</span><span class="p">:]</span><span class="o">-=</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span>
    <span class="c1">#ks=ks/delta_x</span>
    <span class="n">U</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">1.</span><span class="n">j</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">ns</span><span class="p">,</span><span class="n">ks</span><span class="p">))</span>
    <span class="n">ks</span><span class="o">=</span><span class="n">ks</span><span class="o">/</span><span class="n">delta_x</span>
    <span class="k">return</span> <span class="n">ks</span><span class="p">,</span><span class="n">U</span>
</pre></div>
</div>
<p>Now by getting out this unitary (<code class="docutils literal notranslate"><span class="pre">ps,U=MomentumBasis(20,0.1)</span></code>) you can then apply <code class="docutils literal notranslate"><span class="pre">U&#64;psi</span></code> to rotate into the fourier basis.  Take the wave-function in real space and rotate it into the fourer basis. Plot the wave-function squared in the momentum basis and see if (after measurement) in the momentum basis you are likely to get consistent answers for the momentum.</p>
<div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (start)"></img><br></div><div class="cell tag_hide-cell docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell content</p>
<p class="expanded admonition-title">Hide code cell content</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># answer here</span>
</pre></div>
</div>
</div>
</details>
</div>
<div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (end)"></img><br></div><p>While our position resolution is good, our momentum resolution is not that great - it seems we can locate the momentum to within 5’sh.</p>
</section>
<section id="b-measuring-uncertainty">
<h3>b. Measuring Uncertainty<a class="headerlink" href="#b-measuring-uncertainty" title="Link to this heading">#</a></h3>
<p>To get a better handle on this, we want to be able to quantify the uncertainty.   The measure of certainty essentially needs to be a measure of the spread of the wave-function which can be quantified by the variance of the wavefunction in the position or momentum basis - i.e.</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\Delta X = \sqrt{\langle X^2 \rangle - \langle X \rangle^2}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\Delta P = \sqrt{\langle P^2 \rangle - \langle P \rangle^2}\)</span></p></li>
</ul>
<p>Recall that you can get the expectation value of an observable <span class="math notranslate nohighlight">\(O\)</span> by doing <code class="docutils literal notranslate"><span class="pre">psi</span> <span class="pre">&#64;</span> <span class="pre">O</span> <span class="pre">&#64;</span> <span class="pre">psi.T.conjugate()</span></code></p>
<p>Write a function <code class="docutils literal notranslate"><span class="pre">def</span> <span class="pre">uncertainty(psi)</span></code> which returns the <span class="math notranslate nohighlight">\(\Delta X\)</span> and <span class="math notranslate nohighlight">\(\Delta P\)</span> and <span class="math notranslate nohighlight">\(\Delta X \Delta P\)</span>.     It will be convenient to normalize the wave-function as the first step of this function so you can send the function an un-normalized wave-function.</p>
<p>Now compute the uncertainty for the wave-functions above. You should quantify what we say above.  The variance of the position is smallish but the variance of the momentum is much larger and so if we measured we would be getting widely different momentum.</p>
<div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (start)"></img><br></div><div class="cell tag_hide-cell docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell content</p>
<p class="expanded admonition-title">Hide code cell content</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># answer here</span>
</pre></div>
</div>
</div>
</details>
</div>
<div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (end)"></img><br></div><p>Our wave-function does have a tuning paramater <span class="math notranslate nohighlight">\(\alpha\)</span> that will make it more or less concentrated in <span class="math notranslate nohighlight">\(x\)</span> (for example try <span class="math notranslate nohighlight">\(\alpha=0.0001\)</span> in the x-basis). Write some code to tune <span class="math notranslate nohighlight">\(\alpha\)</span> from <span class="math notranslate nohighlight">\(10\)</span> down to <span class="math notranslate nohighlight">\(0.0001\)</span>.  On the same plot, show as a function of <span class="math notranslate nohighlight">\(\alpha\)</span></p>
<ul class="simple">
<li><p>the value of <span class="math notranslate nohighlight">\(\Delta X\)</span></p></li>
<li><p>the value of <span class="math notranslate nohighlight">\(\Delta P\)</span></p></li>
<li><p>the value of <span class="math notranslate nohighlight">\(\Delta X \Delta P\)</span></p></li>
</ul>
<p>What is the minimum value of <span class="math notranslate nohighlight">\(\Delta X \Delta P\)</span> you can find.   The uncertainty principle tells us that <span class="math notranslate nohighlight">\(\Delta X \Delta P &gt;0.5\)</span>.  What’s the closest you get?</p>
<p>(you may find it useful here to work on a logarithmic grid of alpha - i.e.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">alphas</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.0001</span><span class="p">,</span><span class="mf">10.01</span><span class="p">,</span><span class="mf">0.01</span><span class="p">)</span>
<span class="n">alphas</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mf">1.0</span><span class="p">))</span>
</pre></div>
</div>
<div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (start)"></img><br></div><div class="cell tag_hide-cell docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell content</p>
<p class="expanded admonition-title">Hide code cell content</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># answer here</span>
</pre></div>
</div>
</div>
</details>
</div>
<div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (end)"></img><br></div></section>
<section id="c-minimizing-uncertainty">
<h3>c. Minimizing Uncertainty<a class="headerlink" href="#c-minimizing-uncertainty" title="Link to this heading">#</a></h3>
<p>So far we’ve been having trouble finding something that is compact both in real space and in momentum space.  In particular, we haven’t found a wave-function that matches the Heisenberg limit.  In this section, we are going to try to optimize for the minimum uncertainty.  (<em>you want to do this section with a grid spacing of <code class="docutils literal notranslate"><span class="pre">delta_x=0.1</span></code></em>).</p>
<p>We will perform this optimization using python’s <code class="docutils literal notranslate"><span class="pre">scipy.optimize</span></code>.  To do this, we need to write an objective function <code class="docutils literal notranslate"><span class="pre">def</span> <span class="pre">f(psi)</span></code> that takes the wave-function <code class="docutils literal notranslate"><span class="pre">psi</span></code> and returns the thing we want to minimize.</p>
<p>You could do this by calling your <code class="docutils literal notranslate"><span class="pre">uncertainty</span></code> function and just returning <span class="math notranslate nohighlight">\(\Delta X \Delta P\)</span>.  It will be useful to add to our objective function a small penalty for cases where either <span class="math notranslate nohighlight">\(\Delta x\)</span> or <span class="math notranslate nohighlight">\(\Delta P\)</span> are very large (we want to avoid this because we want to know <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(p\)</span> both pretty well and this helps the optimization because there is a subtle issue with our discretization as <span class="math notranslate nohighlight">\(\Delta x \rightarrow 0\)</span> and <span class="math notranslate nohighlight">\(\Delta p\)</span> gets very large).  Therefore, also add <span class="math notranslate nohighlight">\(\text{Real}(0.01 \max(\Delta X,\Delta P))\)</span>  to the return of our objective function.</p>
<p>Now we can call the optimization function.  The optimization function needs to be sent out objective function and a guess - i.e. <code class="docutils literal notranslate"><span class="pre">ans=scipy.optimize.minimize(f,guess)</span></code>.  You can use as your guess <span class="math notranslate nohighlight">\(\sin(0.3141592653589793 x)\)</span> which you can check is not very localized.</p>
<p>Once the optimizations is done, the new wave-function is <code class="docutils literal notranslate"><span class="pre">ans.x</span></code>.  Check the uncertainty of your new wave-function and plot it both in the x-basis and the p-basis.   You may notice that your wave-function looks gaussian. You can double check this by trying to fit/plot a gaussian on top of it.</p>
<div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (start)"></img><br></div><div class="cell tag_hide-cell docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell content</p>
<p class="expanded admonition-title">Hide code cell content</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># answer here</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell content</p>
<p class="expanded admonition-title">Hide code cell content</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># answer here</span>
</pre></div>
</div>
</div>
</details>
</div>
<div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (end)"></img><br></div></section>
<section id="d-coherent-states">
<h3>d. Coherent States<a class="headerlink" href="#d-coherent-states" title="Link to this heading">#</a></h3>
<p>There is a special wave-function that we will consider later called a coherent state.</p>
<p>The wave-function for coherent states are</p>
<div class="math notranslate nohighlight">
\[\Psi(x)=e^{-\frac{1}{2}(x-\alpha\sqrt{2})^2}\]</div>
<p>We will set <span class="math notranslate nohighlight">\(\alpha=0.2\)</span> for this part of the problem.</p>
<p>What is the uncertainty <span class="math notranslate nohighlight">\(\Delta X\)</span> and <span class="math notranslate nohighlight">\(\Delta P\)</span> for this (actually any) coherent state?
Also plot the state.</p>
<div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (start)"></img><br></div><div class="cell tag_hide-cell docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell content</p>
<p class="expanded admonition-title">Hide code cell content</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># answer here</span>
</pre></div>
</div>
</div>
</details>
</div>
<div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (end)"></img><br></div></section>
<section id="e-not-coherent-states">
<h3>e.  Not coherent states<a class="headerlink" href="#e-not-coherent-states" title="Link to this heading">#</a></h3>
<p>So far we’ve seen examples of states which satiate the uncertainty bound while simultaneously having the same uncertainty in <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(p\)</span>.  Verify that this state satiates the Heisenberg uncertainty bound while having different values of <span class="math notranslate nohighlight">\(\Delta X\)</span> and <span class="math notranslate nohighlight">\(\Delta P\)</span></p>
<div class="math notranslate nohighlight">
\[\Psi(x) =  N \exp[-0.3 x^2]\]</div>
<p>where <span class="math notranslate nohighlight">\(N\)</span> is the normalization.</p>
<div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (start)"></img><br></div><div class="cell tag_hide-cell docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell content</p>
<p class="expanded admonition-title">Hide code cell content</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># answer here</span>
</pre></div>
</div>
</div>
</details>
</div>
<div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (start)"></img><br></div></section>
</section>
<section id="exercise-2-harmonic-oscillator-in-real-space">
<h2>Exercise 2. Harmonic Oscillator in Real Space<a class="headerlink" href="#exercise-2-harmonic-oscillator-in-real-space" title="Link to this heading">#</a></h2>
<p>The Hamiltonian for the simple harmonic oscillator is</p>
<div class="math notranslate nohighlight">
\[H=\frac{\hat{P}^2}{2m} + \frac{1}{2}m\omega^2 \hat{X}^2\]</div>
<p>We know that <span class="math notranslate nohighlight">\(\hat{P}=-i\hbar \frac{\partial}{\partial x}\)</span> leaving us with</p>
<div class="math notranslate nohighlight">
\[H=-\frac{\hbar^2}{2m} \frac{\partial^2}{\partial x^2} + \frac{1}{2}m\omega^2 x^2\]</div>
<p>Working in units where <span class="math notranslate nohighlight">\(\hbar=1\)</span> and selecting <span class="math notranslate nohighlight">\(m=\omega=1\)</span> we are then left with</p>
<div class="math notranslate nohighlight">
\[H=\frac{1}{2}\left(-\frac{\partial^2}{\partial x^2} + x^2\right)\]</div>
<section id="a-hamiltonian-and-eigenvalues">
<h3>a. Hamiltonian and Eigenvalues<a class="headerlink" href="#a-hamiltonian-and-eigenvalues" title="Link to this heading">#</a></h3>
<p>Let’s start by generating the matrix for this Hamiltonian.  We are again going to use <span class="math notranslate nohighlight">\(-10 \leq x \leq 10\)</span> via</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">delta_x</span><span class="o">=</span><span class="mf">0.01</span>
<span class="n">xs</span><span class="o">=</span><span class="n">SetupGrid</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="n">delta_x</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="n">P2</span><span class="o">=</span><span class="n">SetupObservables</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span><span class="n">delta_x</span><span class="p">)</span>
</pre></div>
</div>
<p>You can generate the kinetic piece of the Hamiltonian in the same way that you did for the particle in a box.  Like the finite well potential, the potential is still on the diagonal and is equal to <span class="math notranslate nohighlight">\(x^2\)</span>.  Notice with the units we are using, both the kinetic and potential must b multiplied by 1/2.  Let us start by plotting the first 10 eigenenergies as dots (<code class="docutils literal notranslate"><span class="pre">marker='o',linestyle='None'</span></code>).  What important qualitative feature do you notice about the energy levels.</p>
<div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (start)"></img><br></div><div class="cell tag_hide-cell docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell content</p>
<p class="expanded admonition-title">Hide code cell content</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># answer here</span>
</pre></div>
</div>
</div>
</details>
</div>
<div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (end)"></img><br></div></section>
<section id="b-eigenstates">
<h3>b.  Eigenstates<a class="headerlink" href="#b-eigenstates" title="Link to this heading">#</a></h3>
<p>Now we want to plot the lowest three eigenstates.  Put a label on the lowest three eigenstates by adding a keyword argument to your plot command (<code class="docutils literal notranslate"><span class="pre">label=&quot;Eigenstate</span> <span class="pre">0&quot;</span></code>) and including a legend <code class="docutils literal notranslate"><span class="pre">plt.legend()</span></code> before your <code class="docutils literal notranslate"><span class="pre">plt.show()</span></code>.</p>
<p>Notice how many nodes (zeros) the n’th eigenstate has.</p>
<p>In class, you learned that the expected solution to the Harmonic Oscillator involves Hermite polynomials.  In particular, the n’th eigenstate should be</p>
<div class="math notranslate nohighlight">
\[\Psi_n(x)= \frac{1}{\sqrt{2^n n!}}\left(\frac{m\omega}{\pi \hbar} \right)^{1/4} e^{-\frac{m\omega x^2}{2\hbar}}H_n\left(\sqrt{\frac{m\omega}{\hbar}}x\right)\]</div>
<p>where <span class="math notranslate nohighlight">\(H_n\)</span> are the Hermite polynomials.</p>
<p>In python to get the Hermite polynomials, use</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Herm</span><span class="o">.</span><span class="n">hermval</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span> <span class="n">herm_coeffs</span><span class="p">)</span>
</pre></div>
</div>
<p>where <span class="math notranslate nohighlight">\(xi=\sqrt{m\omega/\hbar}\)</span> and the <code class="docutils literal notranslate"><span class="pre">herm_coefs</span></code> need to be a numpy array of size n+1 with a 1 in spot <span class="math notranslate nohighlight">\(n\)</span> and 0 otherwise.</p>
<ul class="simple">
<li><p>Plot the expected answers on top of your generated answers.</p></li>
</ul>
<p>You may occassionally find that the expected and numerical answer are upside down from each other. This is because the global phase of a wave-function doesn’t matter.  This means you can always multiply a wave-function by -1 and it’s still physically the same. If you find this is happening to you, go ahead and multipy appropriately by -1 to fix it.</p>
<ul class="simple">
<li><p>In addition, print out the uncertainty of these wave-functions.  Are they anywhere near the Heisenberg limit.</p></li>
</ul>
<div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (start)"></img><br></div><div class="cell tag_hide-cell docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell content</p>
<p class="expanded admonition-title">Hide code cell content</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># answer here</span>
</pre></div>
</div>
</div>
</details>
</div>
<div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (end)"></img><br></div></section>
<section id="c-dynamics-and-ehrenfest-theorem">
<h3>c. Dynamics and Ehrenfest theorem<a class="headerlink" href="#c-dynamics-and-ehrenfest-theorem" title="Link to this heading">#</a></h3>
<p>Let’s start with the wave-function <code class="docutils literal notranslate"><span class="pre">psi=(np.sqrt(0.1)*v[:,0]+np.sqrt(0.25)*v[:,1]+1.j*np.sqrt(0.65)*v[:,2]).astype(np.complex128)</span> </code></p>
<p>We want to do time-evolution with this wave-function. You can use your two functions:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">TimeEvolution</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">TimeEvolutionOperator</span></code></p></li>
</ul>
<p>from your previous assignment.</p>
<p>We do want to do an update of the update function so that the animation is slightly more informative. In particular, we are going to want to plot some information about the potential and energy of our state.  Because our y-axis is currently probability (which is at most 1), we will need to rescale the energy (which can get large) so that everything sanely fits on the same axis. To do this, we are going to rescale all our energies by <code class="docutils literal notranslate"><span class="pre">scale=max_value/energy</span></code> where <code class="docutils literal notranslate"><span class="pre">max_value</span></code> is the largest probability your wave-function gets (which we’ve already been calculating for animation) and <code class="docutils literal notranslate"><span class="pre">energy</span></code> is the energy of our initial wave-function, which you can compute (recall the energy doesn’t change as a function of time).</p>
<p><strong>Modifications of the Update Function</strong></p>
<ul class="simple">
<li><p>Plot the Harmonic Oscillator potential on your animation as <code class="docutils literal notranslate"><span class="pre">plt.plot(xs,potential*scale)</span></code></p></li>
<li><p>Draw a red-dashed line at the energy of our state - i.e. <code class="docutils literal notranslate"><span class="pre">plt.axhline(energy*scale)</span></code></p></li>
<li><p>Increaese the <code class="docutils literal notranslate"><span class="pre">ylim</span></code> to 1.5 of max_value</p></li>
<li><p>Make the <code class="docutils literal notranslate"><span class="pre">xlim</span></code> between -5 and 5 (this you may have to change for other animations - it’s not generic but makes everything look better)</p></li>
</ul>
<p>Perform time-evolution with the initial wave-function with a <span class="math notranslate nohighlight">\(\delta t=0.1\)</span> and for a total time of <span class="math notranslate nohighlight">\(t=40\)</span>.  Store the snapshot of the wave-function at each time and animate it.</p>
<p>As in the particle in the box, modify the animation code above to plot a vertical line (<code class="docutils literal notranslate"><span class="pre">plt.axvline(...)</span></code>) at the average position of <span class="math notranslate nohighlight">\(x\)</span> at each moment in time.</p>
<div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (start)"></img><br></div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># answer here</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># answer here</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell content</p>
<p class="expanded admonition-title">Hide code cell content</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># answer here</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell content</p>
<p class="expanded admonition-title">Hide code cell content</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># answer here</span>
</pre></div>
</div>
</div>
</details>
</div>
<div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (end)"></img><br></div><p>As in the particle in the box, takes your list of wave-functions as a function of time and generate from each wave-function a value of <span class="math notranslate nohighlight">\(\langle x \rangle(t)\)</span> and <span class="math notranslate nohighlight">\(\langle p \rangle(t)\)</span> showing (on the subplots as typical)</p>
<p>On the same plot show</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\langle x \rangle(t)\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\langle p \rangle(t)\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\partial \langle x \rangle(t)/\partial t\)</span></p></li>
</ul>
<p>What do you notice about the second two plots?</p>
<p>We are also going to add one more subplot this time:  <code class="docutils literal notranslate"><span class="pre">ax=plt.subplots(3,1)[1]</span></code></p>
<p>For our third subplot what we’d like to plot is</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\frac{\partial \langle p(t) \rangle }{\partial t}\)</span> generated by finite differences or <code class="docutils literal notranslate"><span class="pre">np.gradient</span></code> using your momentum curve above</p></li>
<li><p><span class="math notranslate nohighlight">\(\langle V'(x) \rangle(t)\)</span>   This is the average of the derivative of the potential over the wave-function.  Take the derivative of the potential by hand and then think about what observable you need to get this.</p></li>
</ul>
<p>You should find these latter two bullet points are on top of each other.</p>
<p>This (and the previous plots) are a validation of Ehrenfest Theorem which tells us</p>
<div class="math notranslate nohighlight">
\[ m \frac{d}{dt}\langle x \rangle = \langle p \rangle\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[ \frac{d}{dt} \langle p \rangle = -\langle V'(x)\rangle \]</div>
<p>Finally go ahead and make a phase plot of momentum vs position.</p>
<div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (start)"></img><br></div><div class="cell tag_hide-cell docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell content</p>
<p class="expanded admonition-title">Hide code cell content</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># answer here</span>
</pre></div>
</div>
</div>
</details>
</div>
<div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (end)"></img><br></div></section>
<section id="id1">
<h3>d. Coherent States<a class="headerlink" href="#id1" title="Link to this heading">#</a></h3>
<p>We now wish to run time dynamics on a coherent state. Recall the coherent state (as above) is</p>
<div class="math notranslate nohighlight">
\[\Psi(x) = \frac{1}{N} e^{-\frac{1}{2}(x-\alpha\sqrt{2})^2}\]</div>
<p>where <span class="math notranslate nohighlight">\(N\)</span> normalizes the wave-function.  We will use <span class="math notranslate nohighlight">\(\alpha =3\)</span></p>
<p>Do time-dynamics on this system generating both the animation as well as the other two plots above for this new dynamics.</p>
<p>Add one more line to your plots: the position and velocity of a classical oscillator in the same Harmonic potential starting at <span class="math notranslate nohighlight">\(x=3\sqrt{2}\)</span></p>
<p>What do you notice that’s interesting about the time-evolution of the coherent states.</p>
<p>Does something not quite look right in your animation?</p>
<div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (start)"></img><br></div><div class="cell tag_hide-cell docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell content</p>
<p class="expanded admonition-title">Hide code cell content</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># answer here</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># answer here</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># answer here</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># answer here</span>
</pre></div>
</div>
</div>
</div>
<div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (end)"></img><br></div></section>
</section>
<section id="exercise-3-raising-and-lowering-operators">
<h2>Exercise 3. Raising and Lowering Operators<a class="headerlink" href="#exercise-3-raising-and-lowering-operators" title="Link to this heading">#</a></h2>
<section id="a-raising-and-lowering-operators">
<h3>a. Raising and Lowering Operators<a class="headerlink" href="#a-raising-and-lowering-operators" title="Link to this heading">#</a></h3>
<p>With the Harmonic oscillator, we’ve learned that it is useful to look at raising and lowering operators.</p>
<div class="math notranslate nohighlight">
\[a=\sqrt{\frac{m\omega}{2\hbar}}\left(\hat{X}+\frac{i}{mw}\hat{P}\right)\]</div>
<div class="math notranslate nohighlight">
\[a^\dagger=\sqrt{\frac{m\omega}{2\hbar}}\left(\hat{X}-\frac{i}{mw}\hat{P}\right)\]</div>
<p>Build both <span class="math notranslate nohighlight">\(a^\dagger\)</span> and <span class="math notranslate nohighlight">\(a\)</span> in the real space basis.</p>
<ul class="simple">
<li><p>Verify that the operators are complex conjugates of each other (by daggering a and subtracting <span class="math notranslate nohighlight">\(a^\dagger\)</span> and making sure they are zero  - i.e. check that the maximum of the absolute value of the difference is zero)</p></li>
<li><p>Look at the matshow of the upper left of the matrix <code class="docutils literal notranslate"><span class="pre">plt.matshow(a[0:10,0:10])</span></code>.  Can you understand why this is what this looks like.</p></li>
</ul>
<p>We expect that the raising operator has the property that when it acts on an eigenstate <span class="math notranslate nohighlight">\(|n-1\rangle\)</span> it should produce the eigenstate <span class="math notranslate nohighlight">\(\sqrt{n}\)</span> times eigenstate <span class="math notranslate nohighlight">\(|n\rangle\)</span>.  Let’s check that by plotting.  Plot <span class="math notranslate nohighlight">\(\sqrt{4}  |\Psi_4 \rangle\)</span> and <span class="math notranslate nohighlight">\(a^\dagger |\Psi_3\rangle\)</span> and verify that they give the same result.   Again be cognizant that you might need to flip one of the states.</p>
<p>Similarly let’s check that <span class="math notranslate nohighlight">\(a\)</span> lowers a state.  Verify that eigenstate 4 is the same as eigenstate 5 lowered with a coefficient of <span class="math notranslate nohighlight">\(\sqrt{5}\)</span>.</p>
<p>Also verify that the lowering operator destroys the ground state - i.e. check that <span class="math notranslate nohighlight">\(a^\dagger \Psi_0\)</span> is actually zero. (Remember to check the scale of your graph as it might have some features but essentially be zero)</p>
<div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (start)"></img><br></div><div class="cell tag_hide-cell docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell content</p>
<p class="expanded admonition-title">Hide code cell content</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># answer here</span>
</pre></div>
</div>
</div>
</details>
</div>
<div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (end)"></img><br></div></section>
<section id="b-verifying-the-norms-and-number-operators">
<h3>b. Verifying the norms and number operators<a class="headerlink" href="#b-verifying-the-norms-and-number-operators" title="Link to this heading">#</a></h3>
<p>Now we would like to further verify that the raising and lowering operators always act with the additional <span class="math notranslate nohighlight">\(\sqrt{N}\)</span> term.  Since our eigenstates start normalized, if we compute the norm (<code class="docutils literal notranslate"><span class="pre">np.linalg.norm</span></code>) of the eigenstates after they’ve been hit by the raising and lowering operators you should find that their norm is <span class="math notranslate nohighlight">\(\sqrt{N}\)</span>.  Verify this by</p>
<ul class="simple">
<li><p>plotting the norm of the eigenstates (separately for the raising and lower operator) hitting the first ten eigenstates</p></li>
<li><p>plotting <span class="math notranslate nohighlight">\(\sqrt{N}\)</span></p></li>
</ul>
<p>and checking that they are the same</p>
<p>We can also check that <span class="math notranslate nohighlight">\(a^\dagger a\)</span> is a number operator.  Plot again for the first ten eigenstates, the expectation value  of <span class="math notranslate nohighlight">\(a^\dagger a\)</span> in those eigenstates.</p>
<div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (start)"></img><br></div><div class="cell tag_hide-cell docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell content</p>
<p class="expanded admonition-title">Hide code cell content</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># answer here</span>
</pre></div>
</div>
</div>
</details>
</div>
<div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (end)"></img><br></div></section>
<section id="c-write-it-in-the-basis-of-number-operators">
<h3>c.  Write it in the basis of number operators<a class="headerlink" href="#c-write-it-in-the-basis-of-number-operators" title="Link to this heading">#</a></h3>
<p>So far we’ve been looking at We would like to go ahead and write <span class="math notranslate nohighlight">\(a^\dagger\)</span> and <span class="math notranslate nohighlight">\(a\)</span> in the Harmonic Oscillator basis.  In this basis, what we expect to see is that both the raising and lowering operators are just off-diagonal above and below. To rotate an operator from the position basis into the ?Harmonic oscillator basis, you want to do <code class="docutils literal notranslate"> <span class="pre">v.T.conjugate()</span> <span class="pre">&#64;</span> <span class="pre">O</span> <span class="pre">&#64;</span> <span class="pre">v</span></code> for an operator <code class="docutils literal notranslate"><span class="pre">O</span></code>.  Go ahead and rotate <span class="math notranslate nohighlight">\(a\)</span>, <span class="math notranslate nohighlight">\(a^\dagger\)</span> and <span class="math notranslate nohighlight">\(aa^\dagger\)</span> into the Harmonic oscillator basis and look at up the top <span class="math notranslate nohighlight">\(10 \times 10\)</span> chunk. Does it make sense</p>
<div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (start)"></img><br></div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># answer here</span>
</pre></div>
</div>
</div>
</div>
<div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (end)"></img><br></div></section>
<section id="d-warts">
<h3>d. Warts<a class="headerlink" href="#d-warts" title="Link to this heading">#</a></h3>
<p>So far everything has worked out well when we discretized things.  In this section, we just mention a couple warts that you need to look out for.</p>
<ul class="simple">
<li><p>The simplest thing is just that the eigenstates and eigenvalues start diverging from the true answer due to the finite L and discretization. This is very standard but you can see this here by plotting the eigenstates out to <span class="math notranslate nohighlight">\(n=100\)</span>.  What do you notice? To fix this, you can go ahead and increase <span class="math notranslate nohighlight">\(L=40\)</span> and see that the eigenstates out to <span class="math notranslate nohighlight">\(n=100\)</span> look fine.</p></li>
</ul>
<div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (start)"></img><br></div><div class="cell tag_hide-cell docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell content</p>
<p class="expanded admonition-title">Hide code cell content</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># answer here</span>
</pre></div>
</div>
</div>
</details>
</div>
<div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (end)"></img><br></div><p>We learned in quantum mechanics that <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(p\)</span> obey canonical commutation relations - i.e. <span class="math notranslate nohighlight">\([X,P]=i\hbar\)</span> (which means explicitly it’s the identity matrix times <span class="math notranslate nohighlight">\(i\hbar\)</span>).</p>
<p>Let’s test this.  Take the <span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(P\)</span> operators and compute their commutator. Do a matshow of the top <span class="math notranslate nohighlight">\(10 \times 10\)</span> piece of the matrix.</p>
<div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (start)"></img><br></div><div class="cell tag_hide-cell docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell content</p>
<p class="expanded admonition-title">Hide code cell content</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># answer here</span>
</pre></div>
</div>
</div>
</details>
</div>
<div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (end)"></img><br></div><p>You may notice that you get something that is not diagonal at all.  Instead their is <span class="math notranslate nohighlight">\(i\hbar\)</span> right off the diagonal. What’s going on!?</p>
<p>Remember that the rows and columns are labelled by <span class="math notranslate nohighlight">\(x\)</span>.  This means that what we expected was</p>
<div class="math notranslate nohighlight">
\[\langle x|[\hat{X},\hat{P}]|x\rangle= i\hbar\]</div>
<p>But what we got was the piece that was just off the diagonal having <span class="math notranslate nohighlight">\(i\hbar\)</span> on it - i.e. you found that</p>
<div class="math notranslate nohighlight">
\[\langle x|[\hat{X},\hat{P}]|x + \Delta x \rangle =\langle x + \Delta x |[\hat{X},\hat{P}]|x  \rangle =  i\hbar\]</div>
<p>This is very close especially since you could take <span class="math notranslate nohighlight">\(\Delta x\)</span> to be very very tiny. So we almost got the right thing.</p>
<p>What went wrong?</p>
<p>When you actually have finite matrices the trace of a commutator always has to be zero:</p>
<div class="math notranslate nohighlight">
\[Tr(XP-PX)=Tr(XP)-Tr(PX)=Tr(XP)-Tr(XP)=0\]</div>
<p>where the matrices in the trace got flipped because the trace is invariant with respect to cycling matrices.  So it’s just impossible to have <span class="math notranslate nohighlight">\(i\hbar\)</span> down the diagonal.  That said, given the closeness it doesn’t cause us much trouble.</p>
<ul class="simple">
<li><p>Finally, we have learned that</p></li>
</ul>
<div class="math notranslate nohighlight">
\[H = \frac{1}{2} + \hbar \omega a a^\dagger\]</div>
<p>is the Harmonic Oscillator Hamiltonian.</p>
<p>Go ahead and diagonalize this in the x-basis and plot the first 100 eigenvalues.</p>
<p>You’ll notice a set of eigenvalues that you are used to (which can correspond to the eigenvectors you are used to) and an erroneous set of eigenvalues.  This is essentially coming from the fact that <code class="docutils literal notranslate"><span class="pre">P&#64;P</span></code> and <code class="docutils literal notranslate"><span class="pre">P2</span></code> are different matrices.  You might think that this is some technical issue but it’s actually deep and fundamental and causes all sorts of trouble in lattice gauge theory. It goes by the name Fermion doubling and you can see a description of the problem (and the piece that’s very relevant here) is you look at this <a class="reference external" href="https://en.wikipedia.org/wiki/Fermion_doubling">Wikipedia article</a> and look at the section on derivative discretization.</p>
<div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (start)"></img><br></div><div class="cell tag_hide-cell docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell content</p>
<p class="expanded admonition-title">Hide code cell content</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># answer here</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell content</p>
<p class="expanded admonition-title">Hide code cell content</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># answer here</span>
</pre></div>
</div>
</div>
</details>
</div>
<div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (end)"></img><br></div></section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="ParticleInAFiniteWell.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Particle with a Finite Potential</p>
      </div>
    </a>
    <a class="right-next"
       href="Hydrogen.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Hydrogen Atom</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-1-the-uncertainty-principle">Exercise 1.  The Uncertainty Principle</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-the-fourier-basis">a. The Fourier Basis</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#b-measuring-uncertainty">b. Measuring Uncertainty</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#c-minimizing-uncertainty">c. Minimizing Uncertainty</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#d-coherent-states">d. Coherent States</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#e-not-coherent-states">e.  Not coherent states</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-2-harmonic-oscillator-in-real-space">Exercise 2. Harmonic Oscillator in Real Space</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-hamiltonian-and-eigenvalues">a. Hamiltonian and Eigenvalues</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#b-eigenstates">b.  Eigenstates</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#c-dynamics-and-ehrenfest-theorem">c. Dynamics and Ehrenfest theorem</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">d. Coherent States</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-3-raising-and-lowering-operators">Exercise 3. Raising and Lowering Operators</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-raising-and-lowering-operators">a. Raising and Lowering Operators</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#b-verifying-the-norms-and-number-operators">b. Verifying the norms and number operators</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#c-write-it-in-the-basis-of-number-operators">c.  Write it in the basis of number operators</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#d-warts">d. Warts</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Bryan Clark
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>