
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Perturbation Theory &#8212; Computation in Quantum Mechanics  (for Phys486)# The title of the book. Will be placed in the left navbar.</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'PerturbationTheory';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Hydrogen Atom" href="Hydrogen.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="Computation in Quantum Mechanics  (for Phys486)# The title of the book. Will be placed in the left navbar. - Home"/>
    <img src="_static/logo.png" class="logo__image only-dark pst-js-only" alt="Computation in Quantum Mechanics  (for Phys486)# The title of the book. Will be placed in the left navbar. - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Quantum Mechanics
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="ParticleInABox.html">Particle in a Box</a></li>
<li class="toctree-l1"><a class="reference internal" href="ParticleInAFiniteWell.html">Particle with a Finite Potential</a></li>
<li class="toctree-l1"><a class="reference internal" href="HarmonicOscillator.html">Harmonic Oscillator and the Uncertainty Principle</a></li>
<li class="toctree-l1"><a class="reference internal" href="Hydrogen.html">Hydrogen Atom</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Perturbation Theory</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/illinois-compphys/QM/blob/main/quantum_mechanics/PerturbationTheory.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Colab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Colab logo" src="_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/PerturbationTheory.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Perturbation Theory</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-1-two-particles-in-a-one-dimensional-harmonic-oscillator">Exercise 1.  Two Particles in a one-dimensional Harmonic Oscillator</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-a-two-particle-wave-function">a.  A two particle wave-function</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#b-the-simple-harmonic-oscillator-non-interacting-wave-functions">b.  The Simple Harmonic Oscillator: Non-interacting wave-functions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#c-two-particle-non-interacting-eigenstates">c.  Two Particle Non-interacting Eigenstates</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#d-the-interaction">d. The Interaction</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#e-first-order-correction-to-the-energy">e. First order correction to the energy</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#f-first-order-correction-to-the-wave-function">f. First order correction to the wave-function</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#g-second-order-correction-to-the-energy">g. Second order correction to the energy</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#h-exact-answer">h. Exact Answer</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#i-higher-order-corrections-to-the-energy-optional">i. Higher order corrections to the energy  (<em>optional</em>)</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="perturbation-theory">
<h1>Perturbation Theory<a class="headerlink" href="#perturbation-theory" title="Link to this heading">#</a></h1>
<ul class="simple">
<li><p><strong>Author:</strong></p></li>
<li><p><strong>Date:</strong></p></li>
<li><p><strong>Time spent on this assignment:</strong></p></li>
</ul>
<div class="cell tag_hide-output docutils container">
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">functools</span><span class="w"> </span><span class="kn">import</span> <span class="n">partial</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pylab</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">scipy</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">scipy</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">math</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.animation</span><span class="w"> </span><span class="kn">import</span> <span class="n">FuncAnimation</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">IPython.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">HTML</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy.polynomial.hermite</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">Herm</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">math</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">scipy.optimize</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">functools</span><span class="w"> </span><span class="kn">import</span> <span class="n">partial</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.ticker</span><span class="w"> </span><span class="kn">import</span> <span class="n">MaxNLocator</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.animation</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">animation</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">IPython.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">HTML</span>
<span class="k">def</span><span class="w"> </span><span class="nf">resetMe</span><span class="p">(</span><span class="n">keepList</span><span class="o">=</span><span class="p">[]):</span>
    <span class="n">ll</span><span class="o">=%</span><span class="k">who_ls</span>
    <span class="n">keepList</span><span class="o">=</span><span class="n">keepList</span><span class="o">+</span><span class="p">[</span><span class="s1">&#39;FuncAnimation&#39;</span><span class="p">,</span><span class="s1">&#39;Herm&#39;</span><span class="p">,</span><span class="s1">&#39;HTML&#39;</span><span class="p">,</span><span class="s1">&#39;resetMe&#39;</span><span class="p">,</span><span class="s1">&#39;scipy&#39;</span><span class="p">,</span><span class="s1">&#39;np&#39;</span><span class="p">,</span><span class="s1">&#39;plt&#39;</span><span class="p">,</span><span class="s1">&#39;math&#39;</span><span class="p">,</span><span class="s1">&#39;jax&#39;</span><span class="p">,</span><span class="s1">&#39;jnp&#39;</span><span class="p">,</span><span class="s1">&#39;jit&#39;</span><span class="p">,</span><span class="s1">&#39;grad&#39;</span><span class="p">,</span><span class="s1">&#39;HTML&#39;</span><span class="p">,</span><span class="s1">&#39;animation&#39;</span><span class="p">,</span><span class="s1">&#39;animateMe_singlePendula&#39;</span><span class="p">,</span><span class="s1">&#39;partial&#39;</span><span class="p">,</span><span class="s1">&#39;pyscf&#39;</span><span class="p">,</span><span class="s1">&#39;MaxNLocator&#39;</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">iiii</span> <span class="ow">in</span> <span class="n">keepList</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">iiii</span> <span class="ow">in</span> <span class="n">ll</span><span class="p">:</span>
            <span class="n">ll</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">iiii</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">iiii</span> <span class="ow">in</span> <span class="n">ll</span><span class="p">:</span>
        <span class="n">jjjj</span><span class="o">=</span><span class="s2">&quot;^&quot;</span><span class="o">+</span><span class="n">iiii</span><span class="o">+</span><span class="s2">&quot;$&quot;</span>
        <span class="o">%</span><span class="k">reset_selective</span> -f {jjjj}
    <span class="n">ll</span><span class="o">=%</span><span class="k">who_ls</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;font.size&quot;</span><span class="p">:</span> <span class="mi">14</span><span class="p">})</span>
    <span class="k">return</span>
<span class="n">resetMe</span><span class="p">()</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">datetime</span><span class="p">;</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
</pre></div>
</div>
</div>
<details class="hide below-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell output</span>
<span class="expanded">Hide code cell output</span>
</summary>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">line</span> <span class="mi">4</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="kn">from</span><span class="w"> </span><span class="nn">functools</span><span class="w"> </span><span class="kn">import</span> <span class="n">partial</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="kn">import</span><span class="w"> </span><span class="nn">pylab</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="ne">----&gt; </span><span class="mi">4</span> <span class="kn">import</span><span class="w"> </span><span class="nn">scipy</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span> <span class="kn">import</span><span class="w"> </span><span class="nn">scipy</span>

<span class="ne">ModuleNotFoundError</span>: No module named &#39;scipy&#39;
</pre></div>
</div>
</div>
</details>
</div>
<section id="exercise-1-two-particles-in-a-one-dimensional-harmonic-oscillator">
<h2>Exercise 1.  Two Particles in a one-dimensional Harmonic Oscillator<a class="headerlink" href="#exercise-1-two-particles-in-a-one-dimensional-harmonic-oscillator" title="Link to this heading">#</a></h2>
<p>So far we’ve looked at the interaction of a single particle in a one-dimensional Harmonic oscillator potential.  In this exercise, we are going to go beyond this and look at two distinguishable particles in a Harmonic oscillator potential.   We are going to start by assuming those particles are not interacting and then we are going to introduce a repulsive interaction between them.</p>
<p>Suppose we can represent the wave-function for a single particle as  <span class="math notranslate nohighlight">\(\phi_a(x)\)</span> or <span class="math notranslate nohighlight">\(\phi_b(x)\)</span>, then the wave-function for two (non-interacting) particles can be represented as a product of any of the single-particle wave-functions - an example two-particle wave-function might be something like</p>
<div class="math notranslate nohighlight">
\[\Psi(x_1,x_2) = \phi_a(x_1)\phi_a(x_2)\]</div>
<p>or it could be</p>
<div class="math notranslate nohighlight">
\[\Psi(x_1,x_2) = \phi_b(x_1)\phi_a(x_2)\]</div>
<p>Previously on a computer, we were able to represent the single-particle wave-functions as a vector <code class="docutils literal notranslate"><span class="pre">phi_a</span></code> or <code class="docutils literal notranslate"><span class="pre">phi_b</span></code> that was the length of our grid (say 200 points).  To represent the two particle wave-function, we can represent it by a vector of  length <span class="math notranslate nohighlight">\(200^2\)</span> points - we need an amplitude for every possible value of <span class="math notranslate nohighlight">\(x_1\)</span> and <span class="math notranslate nohighlight">\(x_2\)</span>.  To get that vector, we need to use a linear-algebra tool called the Kronecker product.  For this last example, we would have  <code class="docutils literal notranslate"><span class="pre">Psi=np.kron(phi_b,phi_a)</span></code>.</p>
<p>It is important to realize that that is very different from just multiplying the two wavefuctions!
Without interactions, the two particles live in their own, separate Hilbert spaces.
In Dirac notation, the same would be written as</p>
<div class="math notranslate nohighlight">
\[\ket{\Psi} = \ket{\phi_a}\otimes\ket{\phi_b}\]</div>
<p>where <span class="math notranslate nohighlight">\(\otimes\)</span> is the Kronecker product.</p>
</section>
<section id="a-a-two-particle-wave-function">
<h2>a.  A two particle wave-function<a class="headerlink" href="#a-a-two-particle-wave-function" title="Link to this heading">#</a></h2>
<p>Suppose we are working on grid</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">L</span><span class="o">=</span><span class="mi">20</span>
<span class="n">xs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">L</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">L</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">200</span><span class="p">)</span>
</pre></div>
</div>
<p>We then might have a one-particle wave-function <code class="docutils literal notranslate"><span class="pre">phi_a=np.cos(xs*2*np.pi/L)</span></code> and another one particle wave-function <code class="docutils literal notranslate"><span class="pre">phi_b=np.cos(xs*4*np.pi/L)</span></code></p>
<p>Go ahead and</p>
<ul class="simple">
<li><p>plot these two wave-functions <span class="math notranslate nohighlight">\(\phi_a\)</span> and <span class="math notranslate nohighlight">\(\phi_b\)</span>.</p></li>
<li><p>make the vector for the wave-function <span class="math notranslate nohighlight">\(\Psi(x_1,x_2)= \phi_a(x_1)\phi_b(x_2)\)</span></p></li>
<li><p>Verify this new vector is of length <span class="math notranslate nohighlight">\(200\)</span>^2</p></li>
</ul>
<p>As a reminder on the numerical tools we are using:</p>
<ul class="simple">
<li><p>our preferred tool for plotting functions is <a class="reference external" href="https://matplotlib.org/stable/">matplotlib</a>.</p></li>
<li><p>For plotting simple functions, we can use the <a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.plot.html">plot</a> function.</p></li>
<li><p>Any function from the <code class="docutils literal notranslate"><span class="pre">np</span></code> domain is part or <a class="reference external" href="https://numpy.org/doc/stable/">numpy</a></p></li>
<li><p>Both matplotlib and numpy have evolved into de-fact standard and daily-use tools for physicists. They come with excellent online documentation. Consult it often when running into problems with syntax or if you struggle to understand any functionality.</p></li>
</ul>
<div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (start)"></img><br></div><div class="cell tag_answer-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">###ANSWER HERE</span>
</pre></div>
</div>
</div>
</div>
<div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (end)"></img><br></div><p>We now want to plot our wave-function <span class="math notranslate nohighlight">\(\Psi(x_1,x_2)\)</span>.  To do this, we want to put <span class="math notranslate nohighlight">\(x_1\)</span> on the x-axis and <span class="math notranslate nohighlight">\(x_2\)</span> on the y-axis.  Then we can use contours or height to represent the amplitude of the joint wavefunction. This can be used to infer the probability of simultaneously having one particle at <span class="math notranslate nohighlight">\(x_1\)</span> and another at <span class="math notranslate nohighlight">\(x_2\)</span> (which is of course <span class="math notranslate nohighlight">\(|\Psi(x_1, x_2)|^2\)</span> – feel free to plot that as well. Use <code class="docutils literal notranslate"><span class="pre">np.abs</span></code> to get the absolute of the wavefunction).<br />
For example, the diagonal of your plot (<span class="math notranslate nohighlight">\(x=y\)</span>) is showing you how likely the two particles are for being on top of each other.</p>
<p>We can set up this plot using</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">Plot2d_help</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span><span class="n">ys</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span><span class="n">plot_3d</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">)</span>
    <span class="n">Z</span> <span class="o">=</span> <span class="n">Z</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">xs</span><span class="p">),</span><span class="nb">len</span><span class="p">(</span><span class="n">ys</span><span class="p">)))</span>
    <span class="k">if</span> <span class="n">plot_3d</span><span class="o">==</span><span class="kc">True</span><span class="p">:</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="k">return</span>

<span class="n">Plot2d</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">Plot2d_help</span><span class="p">,</span><span class="n">x_s</span><span class="p">,</span><span class="n">x_s</span><span class="p">)</span>
</pre></div>
</div>
<p>and then calling</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Plot2d</span><span class="p">(</span><span class="n">Psi</span><span class="p">,</span><span class="n">plot_3d</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>Go ahead and plot your two particle wave-function that you’ve produced above. (you can also check what happens when you set <code class="docutils literal notranslate"><span class="pre">plot_3d=True</span></code>).</p>
<p><strong>Think about why the result you are getting is reasonable. Write a short note in a separate text or markdown cell in which you interpret the plot, and reason why (or why not) it makes sense from what you know about the physics of the problem.</strong></p>
<div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (start)"></img><br></div><div class="cell tag_answer-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">###ANSWER HERE</span>
</pre></div>
</div>
</div>
</div>
<div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (start)"></img><br></div><section id="b-the-simple-harmonic-oscillator-non-interacting-wave-functions">
<h3>b.  The Simple Harmonic Oscillator: Non-interacting wave-functions<a class="headerlink" href="#b-the-simple-harmonic-oscillator-non-interacting-wave-functions" title="Link to this heading">#</a></h3>
<p>We are going to work with two particles in the simple Harmonic oscillator.   We know that the Hamiltonian for a single particle in a Harmonic oscillator is</p>
<div class="math notranslate nohighlight">
\[
H^\textrm{SHO}(x) = -\frac{1}{2}\frac{\partial^2}{\partial x^2} + \frac{1}{2} x^2
\]</div>
<p>and then the Hamiltonian for two non-interacting particles is</p>
<div class="math notranslate nohighlight">
\[
H_0 = H^\textrm{SHO}(x_1) + H^\textrm{SHO}(x_2)
\]</div>
<p>Our first goal will be to work with just <span class="math notranslate nohighlight">\(H^\textrm{SHO}(x)\)</span> (the one particle Hamiltonian) and build the eigenstates and eigenvalues.</p>
<p>It will be convenient to represent everything inside a class:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">SHO</span><span class="p">:</span>
   <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">L</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">L</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">200</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delta_x</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">xs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">xs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Build_H_SHO</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">evals_oneParticle</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">evecs_oneParticle</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigh</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">H_SHO</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">oneParticleStates</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">evals_oneParticle</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">V</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Interaction</span><span class="p">()</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">Build_H_SHO</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># set up the H^SHO matrix and get the eigenvalues</span>
        <span class="c1">#### do stuff</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">H_SHO</span><span class="o">=</span><span class="c1"># the H you built.</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">Interaction</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>

</pre></div>
</div>
<p>which we can initialize with</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">H</span><span class="o">=</span><span class="n">SHO</span><span class="p">()</span>
</pre></div>
</div>
<p>The only big difference with working in a class is that to access the variables of the class (and the functions) we need to prepend <code class="docutils literal notranslate"><span class="pre">self.</span></code> to everything that is local within the class (but not to variables that are local within a function)</p>
<p>You now need to write <code class="docutils literal notranslate"><span class="pre">Build_H_SHO(self)</span></code> which should build the Hamiltonian for the single particle eigenstates. To do this:</p>
<ul class="simple">
<li><p>Because our grid is length 200, initialize a zero matrix the size of the grid - i.e. <code class="docutils literal notranslate"><span class="pre">H0_oneParticle=np.zeros((200,200))</span></code></p></li>
<li><p>Loop <code class="docutils literal notranslate"><span class="pre">i</span></code> over the 200 elements of your grid:</p>
<ul>
<li><p>On the diagonal  (<code class="docutils literal notranslate"><span class="pre">H0_oneParticle[i,i]</span></code>) put the potential (<code class="docutils literal notranslate"><span class="pre">0.5*self.xs[i]**2</span></code>).</p></li>
<li><p>Recalling that the stencil for the second derivative <span class="math notranslate nohighlight">\((-1/2) \partial^2/\partial x^2\)</span> is <span class="math notranslate nohighlight">\(1/2 (2 f(x)  - f(x+\delta) - f(x-\delta))/\delta^2\)</span> also add <span class="math notranslate nohighlight">\(0.5 \times 2/\delta^2\)</span> to the diagonal</p></li>
<li><p>Because of the second derivative stencil also put <span class="math notranslate nohighlight">\(0.5 \times (-1/\delta^2)\)</span> on the element right above and below the diagonal - i.e. <code class="docutils literal notranslate"><span class="pre">H0_oneParticle[i+1,i]</span></code> and <code class="docutils literal notranslate"><span class="pre">H0_oneParticle[i,i+1]</span></code></p></li>
</ul>
</li>
</ul>
<p>Once you write the full one-particle Hamiltonian notice that the <code class="docutils literal notranslate"><span class="pre">__init__</span></code> function should then diagonalize it.    This means that if you call
<code class="docutils literal notranslate"><span class="pre">H.evecs_oneParticle[:,i]</span></code> you should get the i’th eigenstate of the one-particle Harmonic oscillator.</p>
<p>Go ahead and plot (in one dimension) the lowest two eigenstates and make sure that they are correct (i.e. what you know the lowest eigenstates of the Harmonic oscillator are).  You can plot with <code class="docutils literal notranslate"><span class="pre">plt.plot(H.xs,H.evecs_oneParticle[:,0])</span></code>.  Also verify that the two lowest eigenenergies (i.e <code class="docutils literal notranslate"><span class="pre">H0.evals_oneParticle[0]</span></code> for the lowest energy) are correct.</p>
<div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (start)"></img><br></div><div class="cell tag_answer-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">###ANSWER HERE</span>
</pre></div>
</div>
</div>
</div>
<div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (start)"></img><br></div></section>
<section id="c-two-particle-non-interacting-eigenstates">
<h3>c.  Two Particle Non-interacting Eigenstates<a class="headerlink" href="#c-two-particle-non-interacting-eigenstates" title="Link to this heading">#</a></h3>
<p>Now that you have the single particle non-interacting eigenstates, we need to be able to get the two-particle non-interacting eigenstates using <code class="docutils literal notranslate"><span class="pre">np.kron</span></code>.</p>
<p>Add a function to your class <code class="docutils literal notranslate"><span class="pre">get_eigenstate(self,n)</span></code>  so that when you call <code class="docutils literal notranslate"><span class="pre">H0.get_eigenstate(4)</span></code> it returns the fourth eigenstate of the non-interacting problem.  The <span class="math notranslate nohighlight">\(n\)</span>’th eigenstate of the non-interacting Harmonic oscillator should be</p>
<div class="math notranslate nohighlight">
\[ 
\Psi_{n}(x_1,x_2) = \phi_{n//200}(x_1) \phi_{n \% 200}(x_2)
\]</div>
<p>where <span class="math notranslate nohighlight">\(\phi_i\)</span> is the <span class="math notranslate nohighlight">\(i\)</span>’th eigenstate of the non-interacting Harmonic oscillator that you’ve already stored in <code class="docutils literal notranslate"><span class="pre">self.evecs_oneParticle</span></code>.
Note on the indexing: in the vector of <span class="math notranslate nohighlight">\(\Psi_{n}(x_1,x_2)\)</span>, eigenstates are not ordered by energy, given how we construct the two-particle wavefunction: <span class="math notranslate nohighlight">\(\Psi_0 = \phi_0 \phi_0\)</span>, <span class="math notranslate nohighlight">\(\Psi_1 = \phi_0 \phi_1\)</span>, …, <span class="math notranslate nohighlight">\(\Psi_{199} = \phi_0 \phi_{199}\)</span>, <span class="math notranslate nohighlight">\(\Psi_{200} = \phi_1 \phi_0\)</span>, …, <span class="math notranslate nohighlight">\(\Psi_{200 \times 200 - 1} = \phi_{199} \phi_{199}\)</span>.</p>
<p>Also write a function <code class="docutils literal notranslate"><span class="pre">get_eigenvalue(self,n)</span></code> which returns the <span class="math notranslate nohighlight">\(n'\)</span>th eigenvalue (recalling that the eigenvalue of the problem is just the sum of the one-particle eigenstates).</p>
<p>(These eigenvectors and eigenvalues won’t be ordered by energy.  This is ok)
Also write a function <code class="docutils literal notranslate"><span class="pre">get_eigenvalue(self,n)</span></code> which returns the <span class="math notranslate nohighlight">\(n'\)</span>th eigenvalue (recalling that the eigenvalue of the problem is just the sum of the one-particle eigenstates).</p>
<p>Check that the first couple eigenvalues <code class="docutils literal notranslate"><span class="pre">H.get_eigenvalue(0),</span> <span class="pre">H.get_eigenvalue(1)</span></code> are correct.  Also plot your ground state <code class="docutils literal notranslate"><span class="pre">Plot2d(H.get_eigenstate(0)</span></code>.   Think about what it’s telling you.</p>
<p>Go ahead and do this and then comment on the following thing about the ground state</p>
<ul class="simple">
<li><p>Is it symmetric - why or why not?</p></li>
<li><p>Is it likely for the particles to be in the same place?</p></li>
<li><p>Does one particles location depend on where the other particle is?</p></li>
</ul>
<div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (start)"></img><br></div><div class="cell tag_answer-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">###ANSWER HERE</span>
</pre></div>
</div>
</div>
</div>
<div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (start)"></img><br></div></section>
<section id="d-the-interaction">
<h3>d. The Interaction<a class="headerlink" href="#d-the-interaction" title="Link to this heading">#</a></h3>
<p>Now we would like to understand what happens when we add an interaction between the two particles:  the two particles like to be apart and not touch each other.  Let us define a new interacting Hamiltonian</p>
<div class="math notranslate nohighlight">
\[
H = H_0(x_1,x_2) + V(x_1,x_2)
\]</div>
<p>where the interaction between the two particles is</p>
<div class="math notranslate nohighlight">
\[
V(x_1,x_2) = e^{-2(x_1-x_2)^2}
\]</div>
<p>will eventually be treated as a perturbation.</p>
<p>We now need to fill in the interaction piece of our Hamiltonian by writing the function <code class="docutils literal notranslate"><span class="pre">Interaction()</span></code> in our class which should generate the interaction and return a vector of length <span class="math notranslate nohighlight">\(200^2\)</span> (this is the right size because it is telling us for each value of <span class="math notranslate nohighlight">\(x_1\)</span> and <span class="math notranslate nohighlight">\(x_2\)</span> what is <span class="math notranslate nohighlight">\(V(x_1,x_2)\)</span>).</p>
<p>It is easiest to create a <span class="math notranslate nohighlight">\(200 \times 200\)</span> matrix where the rows represent the <span class="math notranslate nohighlight">\(x_1\)</span> and the columns represent <span class="math notranslate nohighlight">\(x_2\)</span>.  Then we can resize it <code class="docutils literal notranslate"><span class="pre">V.resize(200**2)</span></code> to make it into the appropriate size vector.</p>
<p>To create the matrix, you can use <code class="docutils literal notranslate"><span class="pre">x_1,x_2=np.meshgrid(H.xs,H.xs)</span></code> to create matrices you need to subtract.  To understand what <code class="docutils literal notranslate"><span class="pre">meshgrid</span></code> has done, it’s useful to plot them with</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">contour</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">H</span><span class="o">.</span><span class="n">xs</span><span class="p">,</span><span class="n">H</span><span class="o">.</span><span class="n">xs</span><span class="p">,</span><span class="n">x_1</span><span class="p">,</span><span class="n">levels</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span><span class="n">vmin</span><span class="o">=-</span><span class="mi">10</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;hsv&#39;</span><span class="p">)</span>
<span class="n">values</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">11</span><span class="p">)</span>
<span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">contour</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>for both <span class="math notranslate nohighlight">\(x_1\)</span> and <span class="math notranslate nohighlight">\(x_2\)</span> to see what those two different matrices look like and then to plot</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">contour</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">H</span><span class="o">.</span><span class="n">xs</span><span class="p">,</span><span class="n">H</span><span class="o">.</span><span class="n">xs</span><span class="p">,</span><span class="n">x_1</span><span class="o">-</span><span class="n">x_2</span><span class="p">,</span><span class="n">levels</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;hsv&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>to plot what their difference looks like.</p>
<p>Once you’ve made <code class="docutils literal notranslate"><span class="pre">x_1-x_2</span></code> you can use this difference to make the full interaction (<code class="docutils literal notranslate"><span class="pre">np.exp</span></code> exponentiates and <code class="docutils literal notranslate"><span class="pre">**</span></code> is how you take things to a power).  Then you can resize it properly and return it from the function.</p>
<p>To check that everything is working go ahead and plot <code class="docutils literal notranslate"><span class="pre">Plot2d(H.V)</span></code> and understand if that’s what you expected.
Comment on the result, comparing it to what you already know about the physics from the course.</p>
<div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (start)"></img><br></div><div class="cell tag_answer-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">###ANSWER HERE</span>
</pre></div>
</div>
</div>
</div>
<div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (start)"></img><br></div></section>
<section id="e-first-order-correction-to-the-energy">
<h3>e. First order correction to the energy<a class="headerlink" href="#e-first-order-correction-to-the-energy" title="Link to this heading">#</a></h3>
<p>We are now ready to put everything together to get our first order correction to the energy.</p>
<p>Let us write a function <code class="docutils literal notranslate"><span class="pre">FirstOrderEnergy(H)</span></code> which takes the Hamiltonian and return the first order correction <code class="docutils literal notranslate"><span class="pre">E1</span></code> which is</p>
<div class="math notranslate nohighlight">
\[
E_1 = \langle n^{(0)} | V | n^{(0)} \rangle
\]</div>
<p>where <span class="math notranslate nohighlight">\(|n^{(0)}\rangle\)</span> is the ground state wave-function of <span class="math notranslate nohighlight">\(H_0\)</span>.</p>
<p>Naively you might want to compute this by turning <span class="math notranslate nohighlight">\(V\)</span> into a <span class="math notranslate nohighlight">\(200^2 \times 200^2\)</span> matrix with the potential down the diagonal.  While correct, this will cause your computer to run out of RAM and crash.  Instead you can compute <span class="math notranslate nohighlight">\(\langle n^{(0)}| V\)</span> by doing  <code class="docutils literal notranslate"><span class="pre">np.multiply(H.get_eigenstate(0).conjugate(),H.V)</span></code>.  This is much more efficient because it scales linearly with the size of the potential.</p>
<p>Report <span class="math notranslate nohighlight">\(E_1\)</span> and <span class="math notranslate nohighlight">\(E_0+E_1\)</span>.</p>
<div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (start)"></img><br></div><div class="cell tag_answer-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">###ANSWER HERE</span>
</pre></div>
</div>
</div>
</div>
<div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (end)"></img><br></div></section>
<section id="f-first-order-correction-to-the-wave-function">
<h3>f. First order correction to the wave-function<a class="headerlink" href="#f-first-order-correction-to-the-wave-function" title="Link to this heading">#</a></h3>
<p>The first order correction to the wave-function is</p>
<div class="math notranslate nohighlight">
\[
|n^{(1)} \rangle = \sum_{k \neq n} \frac{\langle k^{(0)} | V  | n^{(0)} \rangle }{E_n^0 - E_k^0} |k^{(0)}\rangle
\]</div>
<p>Go ahead and write a function <code class="docutils literal notranslate"><span class="pre">FirstOrderWaveFunction(H)</span></code> which returns the  correction <code class="docutils literal notranslate"><span class="pre">n1</span></code>.  You will have to loop over the number of eigenstates <code class="docutils literal notranslate"><span class="pre">H.numStates</span></code> and add on the appropraite term.  Remember to use <code class="docutils literal notranslate"><span class="pre">&#64;</span></code> to do matrix multiplication and <code class="docutils literal notranslate"><span class="pre">*</span></code> to multiply a scalar times a vector (which will be needed when you multiply everything else by <span class="math notranslate nohighlight">\(|k^{(0)}\rangle\)</span>).  This should be a <span class="math notranslate nohighlight">\(200^2\)</span> vector.   Make a 2d plot both of <code class="docutils literal notranslate"><span class="pre">n1</span></code> (which tells you how the correction is made) and <code class="docutils literal notranslate"><span class="pre">n0+n1</span></code> (which tells you what the new wave-function looks like).  What is this telling about how the perturbation is changing the wave-function?</p>
<div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (start)"></img><br></div><div class="cell tag_answer-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">###ANSWER HERE</span>
</pre></div>
</div>
</div>
</div>
<div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (end)"></img><br></div></section>
<section id="g-second-order-correction-to-the-energy">
<h3>g. Second order correction to the energy<a class="headerlink" href="#g-second-order-correction-to-the-energy" title="Link to this heading">#</a></h3>
<p>There are two (equivalent) ways to get the energy to second order.</p>
<p>Either you can do</p>
<div class="math notranslate nohighlight">
\[
E_2 = \sum_{k \neq n} \frac{ |\langle k^{(0)} | V | n^{(0)} \rangle|^2}{E_n^{(0)}-E_k^{(0)}}
\]</div>
<p>which uses only the eigenstates from the 0’th order wave-function or</p>
<div class="math notranslate nohighlight">
\[
\widetilde{E_2} = \langle n^{(1)} | V | n^{(0)}\rangle
\]</div>
<p>Write functions that compute the second order energy in both ways and verify that they are the same.</p>
<div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (start)"></img><br></div><div class="cell tag_answer-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">###ANSWER HERE</span>
</pre></div>
</div>
</div>
</div>
<div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (end)"></img><br></div></section>
<section id="h-exact-answer">
<h3>h. Exact Answer<a class="headerlink" href="#h-exact-answer" title="Link to this heading">#</a></h3>
<p>Now we are going to try to get the exact answer.</p>
<p>To get the part of the Hamiltonian for the interaction we now do need to make a matrix where <span class="math notranslate nohighlight">\(V\)</span> is on the diagonal. Before we were avoiding that because doing so would consume all our RAM. Now, we are going to generate it in a sparse matrix to avoid this problem by doing</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">V</span><span class="o">=</span><span class="n">scipy</span><span class="o">.</span><span class="n">sparse</span><span class="o">.</span><span class="n">diags</span><span class="p">(</span><span class="n">H</span><span class="o">.</span><span class="n">V</span><span class="p">)</span>
</pre></div>
</div>
<p>Now we also need to get the Hamiltonian for the non-interacting piece.  We already have the one-particle Hamiltonian <code class="docutils literal notranslate"><span class="pre">H.H0</span></code>.  As we needed to do when we want from the one-particle wave-function to the two-particle wave-function, we need to take some kronecker products to get the two-particle Hamiltonian.  Formally this is <span class="math notranslate nohighlight">\(H^\textrm{SHO}\otimes I + I \otimes H^\textrm{SHO}\)</span>.  We can generate this in python in a sparse matrix by doing</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">H0_sparse</span><span class="o">=</span><span class="n">scipy</span><span class="o">.</span><span class="n">sparse</span><span class="o">.</span><span class="n">kronsum</span><span class="p">(</span><span class="n">H</span><span class="o">.</span><span class="n">H_SH0</span><span class="p">,</span><span class="n">H</span><span class="o">.</span><span class="n">H_SH0</span><span class="p">)</span>
</pre></div>
</div>
<p>Now we can generate the full sparse matrix <code class="docutils literal notranslate"><span class="pre">H_sparse</span></code> by adding these two terms.</p>
<p>Now, using</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">e</span><span class="p">,</span><span class="n">v</span><span class="o">=</span><span class="n">scipy</span><span class="o">.</span><span class="n">sparse</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigsh</span><span class="p">(</span><span class="n">H_kron</span><span class="p">,</span><span class="n">k</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;SA&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>you can get the ground state energy <span class="math notranslate nohighlight">\(E_0\)</span> and the exact wavefunction <span class="math notranslate nohighlight">\(|\Psi\rangle \)</span>. Do this and report the eigenenergy as well as make a 2d plot of the true wave-function.  How does the plot compare against your first order perturbative correction?</p>
<p>Also plot</p>
<ul class="simple">
<li><p>Cumulative Energy as a function of perturbation order and the exact energy as a horizontal line on this plot</p></li>
<li><p>Difference between the exact energy and the cumulative perturbative energy (on a log scale)</p></li>
<li><p>The absolute value of the pertubative correction <span class="math notranslate nohighlight">\(|E^{(i)}|\)</span> as a function of perturbation order (on a log scale)</p></li>
</ul>
<div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (start)"></img><br></div><div class="cell tag_answer-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">###ANSWER HERE</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_answer-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">###ANSWER HERE</span>
</pre></div>
</div>
</div>
</div>
<div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (start)"></img><br></div></section>
<section id="i-higher-order-corrections-to-the-energy-optional">
<h3>i. Higher order corrections to the energy  (<em>optional</em>)<a class="headerlink" href="#i-higher-order-corrections-to-the-energy-optional" title="Link to this heading">#</a></h3>
<p><strong>This exercise is optional</strong></p>
<p>In a large majority of cases, if you’re using perturbation theory it’s only out to second order in the energy.  Nonetheless, you can go to higher order in perturbation theory and (depending on the convergence of the series) get better results.  There’s a separate question in what cases, it is easy to do so with limited computer time.  In this situation, let’s not worry too much about that and just compute the perturbative corrections out to 30’th order.</p>
<p>To get the k’th order correction to the wave-function you can do</p>
<div class="math notranslate nohighlight">
\[
|n^{(m)}\rangle = \sum_{j \neq n} \frac{1}{E_0^{(0)}-E_j^{(0)}} |j\rangle  \left( - \langle j^{(0)} | V | n^{(k-1)}\rangle  + \sum_{k=1}^{m-1} E^{(k)} \langle j^{(0)} | n^{(m-k)}\rangle \right)
\]</div>
<p>and then use</p>
<div class="math notranslate nohighlight">
\[
E_0^{(m+1)}=\langle n^{(0)} | V | n^{(m)}\rangle
\]</div>
<p>You can iterate these equations over and over again until you reach any arbitrary order in perturbation theory.</p>
<p>Use this to get the corrected energy out to 30’th order in perturbation theory..</p>
<p>Store your energies in wave-functions in an array <code class="docutils literal notranslate"><span class="pre">Psis</span></code> and <code class="docutils literal notranslate"><span class="pre">Es</span></code> respectively (including the orders you’e already computed).  Plot the 2d version of the 30’th order wave-function and plot the same plots with respect to the energy that you’ve plotted aboe.</p>
<div><img src="https://clark.physics.illinois.edu/246img/AnsStart.svg" width=200 align=left alt="Answer (start)"></img><br></div><div class="cell tag_answer-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">###ANSWER HERE</span>
</pre></div>
</div>
</div>
</div>
<div><img src="https://clark.physics.illinois.edu/246img/AnsEnd.svg" width=200 align=left alt="Answer (end)"></img><br></div></section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Hydrogen.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Hydrogen Atom</p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-1-two-particles-in-a-one-dimensional-harmonic-oscillator">Exercise 1.  Two Particles in a one-dimensional Harmonic Oscillator</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-a-two-particle-wave-function">a.  A two particle wave-function</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#b-the-simple-harmonic-oscillator-non-interacting-wave-functions">b.  The Simple Harmonic Oscillator: Non-interacting wave-functions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#c-two-particle-non-interacting-eigenstates">c.  Two Particle Non-interacting Eigenstates</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#d-the-interaction">d. The Interaction</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#e-first-order-correction-to-the-energy">e. First order correction to the energy</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#f-first-order-correction-to-the-wave-function">f. First order correction to the wave-function</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#g-second-order-correction-to-the-energy">g. Second order correction to the energy</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#h-exact-answer">h. Exact Answer</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#i-higher-order-corrections-to-the-energy-optional">i. Higher order corrections to the energy  (<em>optional</em>)</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Bryan Clark
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>